var file_type_map={video:["av","wmv","wav","wma","avi","rm","rmvb","mp4"],music:["mp3","mp4"],exe:["exe","bin"],flash:["swf","fla","as"],image:["gif","jpg","jpeg","png","bmp"],office:["doc","xls","ppt"],pdf:["pdf"],text:["c","cpp","cc","txt"],zip:["tar","zip","gz","rar","7z","bz"],book:["chm"],torrent:["bt","torrent"],font:["ttf","font","fon"]},file_type=function(t){for(k in file_type_map)if(-1!=$.inArray(t,file_type_map[k]))return k;return"unknown"},file_suffix=function(t){var e=t.lastIndexOf("."),o=t.length,a=t.substring(e+1,o);return a},color_map={lightpink:"#FFB6C1",pink:"#FFC0CB",crimson:"#DC143C",lavenderblush:"#FFF0F5",palevioletred:"#DB7093",hotpink:"#FF69B4",deeppink:"#FF1493",mediumvioletred:"#C71585",orchid:"#DA70D6",thistle:"#D8BFD8",plum:"#DDA0DD",violet:"#EE82EE",magenta:"#FF00FF",fuchsia:"#FF00FF",darkmagenta:"#8B008B",purple:"#800080",mediumorchid:"#BA55D3",darkviolet:"#9400D3",darkorchid:"#9932CC",indigo:"#4B0082",blueviolet:"#8A2BE2",mediumpurple:"#9370DB",mediumslateblue:"#7B68EE",slateblue:"#6A5ACD",darkslateblue:"#483D8B",lavender:"#E6E6FA",ghostwhite:"#F8F8FF",blue:"#0000FF",mediumblue:"#0000CD",midnightblue:"#191970",darkblue:"#00008B",navy:"#000080",royalblue:"#4169E1",cornflowerblue:"#6495ED",lightsteelblue:"#B0C4DE",lightslategray:"#778899",slategray:"#708090",dodgerblue:"#1E90FF",aliceblue:"#F0F8FF",steelblue:"#4682B4",lightskyblue:"#87CEFA",skyblue:"#87CEEB",deepskyblue:"#00BFFF",lightblue:"#ADD8E6",powderblue:"#B0E0E6",cadetblue:"#5F9EA0",azure:"#F0FFFF",lightcyan:"#E0FFFF",paleturquoise:"#AFEEEE",cyan:"#00FFFF",aqua:"#00FFFF",darkturquoise:"#00CED1",darkslategray:"#2F4F4F",darkcyan:"#008B8B",teal:"#008080",mediumturquoise:"#48D1CC",lightseagreen:"#20B2AA",turquoise:"#40E0D0",aquamarine:"#7FFFD4",mediumaquamarine:"#66CDAA",mediumspringgreen:"#00FA9A",mintcream:"#F5FFFA",springgreen:"#00FF7F",mediumseagreen:"#3CB371",seagreen:"#2E8B57",honeydew:"#F0FFF0",lightgreen:"#90EE90",palegreen:"#98FB98",darkseagreen:"#8FBC8F",limegreen:"#32CD32",lime:"#00FF00",forestgreen:"#228B22",green:"#008000",darkgreen:"#006400",chartreuse:"#7FFF00",lawngreen:"#7CFC00",greenyellow:"#ADFF2F",darkolivegreen:"#556B2F",yellowgreen:"#9ACD32",olivedrab:"#6B8E23",beige:"#F5F5DC",lightgoldenrodyellow:"#FAFAD2",ivory:"#FFFFF0",lightyellow:"#FFFFE0",yellow:"#FFFF00",olive:"#808000",darkkhaki:"#BDB76B",lemonchiffon:"#FFFACD",palegoldenrod:"#EEE8AA",khaki:"#F0E68C",gold:"#FFD700",cornsilk:"#FFF8DC",goldenrod:"#DAA520",darkgoldenrod:"#B8860B",floralwhite:"#FFFAF0",oldlace:"#FDF5E6",wheat:"#F5DEB3",moccasin:"#FFE4B5",orange:"#FFA500",papayawhip:"#FFEFD5",blanchedalmond:"#FFEBCD",navajowhite:"#FFDEAD",antiquewhite:"#FAEBD7",tan:"#D2B48C",burlywood:"#DEB887",bisque:"#FFE4C4",darkorange:"#FF8C00",linen:"#FAF0E6",peru:"#CD853F",peachpuff:"#FFDAB9",sandybrown:"#F4A460",chocolate:"#D2691E",saddlebrown:"#8B4513",seashell:"#FFF5EE",sienna:"#A0522D",lightsalmon:"#FFA07A",coral:"#FF7F50",orangered:"#FF4500",darksalmon:"#E9967A",tomato:"#FF6347",mistyrose:"#FFE4E1",salmon:"#FA8072",snow:"#FFFAFA",lightcoral:"#F08080",rosybrown:"#BC8F8F",indianred:"#CD5C5C",red:"#FF0000",brown:"#A52A2A",firebrick:"#B22222",darkred:"#8B0000",maroon:"#800000",white:"#FFFFFF",whitesmoke:"#F5F5F5",gainsboro:"#DCDCDC",lightgrey:"#D3D3D3",silver:"#C0C0C0",darkgray:"#A9A9A9",gray:"#808080",dimgray:"#696969",black:"#000000"},color_format=function(t){if(t+="",-1!=t.indexOf("#"))return t;if(-1!=t.indexOf("rgb(")||-1!=t.indexOf("rgba(")){var e=t.match(/^rgb\s*\(([0-9]+),\s*([0-9]+),\s*([0-9]+)\)$/);if(e){var o=(e[1]<16?"0":"")+parseFloat(e[1]).toString(16)+(e[2]<16?"0":"")+parseFloat(e[2]).toString(16)+(e[3]<16?"0":"")+parseFloat(e[3]).toString(16);return"#"+o.toUpperCase()}return"#FFFFFF"}var a=t.toLowerCase();return color_map[a]?color_map[a]:t},font_size_format=function(t){var e="";switch(intval(t)){case 1:e="12px";break;case 2:e="13px";break;case 3:e="16px";break;case 4:e="18px";break;case 5:e="24px";break;case 6:e="32px";break;case 7:e="48px"}return e},node_is_empty=function(t){if(!t||!t.childNodes)return!0;for(var e=0;e<t.childNodes.length;e++){var o=t.childNodes[e];if(1==o.nodeType){if(""!=o.innerText)return!1}else if(3==o.nodeType&&""!=o.innerText)return!1}return!0},font_tag_to_span=function(t){return t=t.replace(/<strong]*>/gi,"<b>"),t=t.replace(/<em>/gi,"<i>"),t=t.replace(/<b>/gi,'<span style="font-weight: bold">'),t=t.replace(/<i>/gi,'<span style="font-style: italic">'),t=t.replace(/<u>/gi,'<span style="text-decoration: underline">'),t=t.replace(/<\/(font|b|i|u)>/gi,"</span>"),t=t.replace(/<(b|i|u)(\s+[^>]*)>/gi,function(t,e,o){return o=$.trim(o),o=o.replace(/(style)\s*=\s*['"]?([^'"]*)['"]?/gi,function(t,o,a){return"b"==e?a=-1==a.indexOf("font-weight")?a+="; font-weight: bold":a.replace(/font\-weight:\s*\w+/gi,"font-weight: bold"):"i"==e?a=-1==a.indexOf("font-style")?a+="; font-style: italic":a.replace(/font\-style:\s*\w+/gi,"font-weight: italic"):"u"==e&&(a=-1==a.indexOf("text-decoration")?a+="; text-decoration: underline":a.replace(/font\-weight:\s*\w+/gi,"text-decoration: underline")),'style="'+a+'"'}),"<span "+o+">"}),t=t.replace(/<(font)\s*([^>]*)>/gi,function(t,e,o){var a="";return(o=$.trim(o))?(o=o.replace(/(\w+)\s*=\s*['"]?([^'"]*)['"]?/gi,function(t,e,o){e=$.trim(e.toLowerCase()),"size"==e?a+="font-size: "+font_size_format(o)+"; ":"family"==e?a+="font-family: "+o+";":"style"==e?a+="font-style: "+o+";":"color"==e&&(a+="color: "+color_format(o)+";")}),a=a?' style="'+a+'"':"","<span"+a+">"):"<span>"})};HTMLSpanElement.prototype.XNEditorKeys=["background","backgroundAttachment","backgroundBlendMode","backgroundClip","backgroundColor","backgroundImage","backgroundOrigin","backgroundPosition","backgroundPositionX","backgroundPositionY","backgroundRepeat","backgroundRepeatX","backgroundRepeatY","backgroundSize","font","fontKerning","fontKerning","fontSize","fontStretch","fontStyle","fontVariant","fontVariantLigatures","fontWeight","color","textDecoration"],HTMLSpanElement.prototype.getStyleArray=function(t){var e=this,o=[];if(t)var a=e.currentStyle?e.currentStyle:document.defaultView.getComputedStyle(e,null);else var a=e.style;for(var i=0;i<HTMLSpanElement.prototype.XNEditorKeys.length;i++){var n=HTMLSpanElement.prototype.XNEditorKeys[i],r=a[n];if(r&&"background"==n){r=r.replace(/,\s/gi,",");var s=r.split(" ");"rgb"==s[0].substr(0,3)&&(s[0]=color_format(s[0])),r=s.join(" ")}else if("backgroundColor"==n||"color"==n)var r=color_format(r);o.push(r)}return o},HTMLElement.prototype.removeAndMoveUpChildren=function(){for(;this.childNodes.length>0;)this.parentNode.insertBefore(this.childNodes[0],this);this.parentNode.removeChild(this)},HTMLElement.prototype.relaceWithNode=function(t){for(this.parentNode.insertBefore(t,this);this.childNodes.length>0;)t.appendChild(this.childNodes[0]);this.parentNode.removeChild(this)},HTMLElement.prototype.clearSpanNodeDeep=function(){if(1==this.nodeType&&0!=this.childNodes.length){for(var t=0;t<this.childNodes.length;t++){var e=this.childNodes[t];1==e.nodeType&&(this.__proto__===HTMLSpanElement.prototype&&e.__proto__===HTMLSpanElement.prototype&&this.cssEqual(e)&&e.removeAndMoveUpChildren(),e.clearSpanNodeDeep())}return this}},HTMLElement.prototype.spanToBIUDeep=function(){if(1==this.nodeType&&0!=this.childNodes.length){var t=this;if(this.__proto__===HTMLSpanElement.prototype){var e=this.cssEqualTag();if(e){for(var o=document.createElement(e);this.childNodes.length>0;)o.appendChild(this.childNodes[0]);this.parentNode.replaceChild(o,this),t=o}}for(var a=0;a<t.childNodes.length;a++){var i=t.childNodes[a];1==i.nodeType&&i.spanToBIUDeep()}return this}},HTMLElement.prototype.getParentNodes=function(t){t||(t=document.body);var e=[];if(this==t)return e;for(var o=this.parentNode;o&&o!=t;)e.push(o),o=o.parentNode;return e},HTMLElement.prototype.hasParentTag=function(t,e){if(this.tagName==t)return!0;e||(e=document.body);for(var o=this.parentNode;o&&o!=e;){if(o.tagName==t)return!0;o=o.parentNode}return!1},HTMLSpanElement.prototype.cssEqualTag=function(){if(!document.simpleTagB){var t=document.createDocumentFragment(),e=document.createElement("span");e.style.fontWeight="bold";var o=document.createElement("span");o.style.fontStyle="italic";var a=document.createElement("span");a.style.textDecoration="underline",t.appendChild(e),t.appendChild(o),t.appendChild(a),document.simpleTagB=t.childNodes[0].getStyleArray(!1).toString(),document.simpleTagI=t.childNodes[1].getStyleArray(!1).toString(),document.simpleTagU=t.childNodes[2].getStyleArray(!1).toString()}var i=this.getStyleArray(!1).toString();return i==document.simpleTagB?"B":i==document.simpleTagI?"I":i==document.simpleTagU?"U":null},HTMLSpanElement.prototype.cssEmpty=function(){for(var t=0;t<HTMLSpanElement.prototype.XNEditorKeys.length;t++){var e=HTMLSpanElement.prototype.XNEditorKeys[t];if(""!=this.style[e])return!1}return!0},HTMLSpanElement.prototype.cssEqual=function(t){var e=this,o=e.getStyleArray(!0),a=t.getStyleArray(!0);return o.toString()==a.toString()},Range.prototype.isChildOf=function(t){for(var e=this.commonAncestorContainer;e&&e.parentNode&&e!=document.body;){if(e==t)return!0;e=e.parentNode}return!1},$.XNEditor=function(t){var e=this,o=this.jtextarea=$("#"+t.textarea),a=o[0].editor;a&&(a.close&&(a.close(),console.log("closed")),a=null);var i=this.jeditor=this.jclone.clone(),n=this.jtoolbar=i.son("div.toolbar"),r=this.jmenu=i.son("div.menu"),s=this.jbody=i.son("div.body");this.jfooter=i.son("div.footer");this.args=t,o.show();var d=o.outerWidth(),l=o.outerHeight();o.hide(),i.insertBefore(o).show(),o.prop("spellcheck",!1).hide(),this.jtextareaclone=o.clone().attr("id",""),this.jtextareaclone.insertBefore(s),o[0].editor=this,this.jtextareaclone[0].editor=this,s.width(d-2),s.height(l-2),this.width=d,this.height=l,o[0].editor=this,this.jtextareaclone[0].editor=this;var c=function(t){return e.menu_hide(),e.range_save(),$(t).hasClass("disabled")};n.son("a.undo").on("click",function(){return c(this)?!0:void e.history(-1)}),n.son("a.redo").on("click",function(){return c(this)?!0:void e.history(1)}),n.son("a.bold").on("click",function(){return c(this)?!0:void e.execCommand("Bold")}),n.son("a.italic").on("click",function(){return c(this)?!0:void e.execCommand("Italic")}),n.son("a.underline").on("click",function(){return c(this)?!0:void e.execCommand("Underline")}),n.son("a.justifyleft").on("click",function(){return c(this)?!0:void e.execCommand("JustifyLeft")}),n.son("a.justifycenter").on("click",function(){return c(this)?!0:void e.execCommand("JustifyCenter")}),n.son("a.justifyright").on("click",function(){return c(this)?!0:void e.execCommand("JustifyRight")}),n.son("a.justifyfull").on("click",function(){return c(this)?!0:void e.execCommand("JustifyFull")}),n.son("a.file").on("click",function(){return c(this)?!0:void 0}),n.son("a.image").son("form.add-photo-form").on("change",function(){$("#uploadForm").find("#uploadForm-token").val(parent.CAICUI.User.token);var t=new FormData($("#uploadForm")[0]);$.ajax({url:"http://api.caicui.com/api/v2.1/commons/fileUpload",type:"POST",data:t,async:!1,cache:!1,contentType:!1,processData:!1,success:function(t){console.log(t);var o='<img src="'+parent.CAICUI.Common.host["static"]+t.data.path+'" width="'+t.data.width+'" height="'+t.data.height+'"/>';e.paste(o)},error:function(t){}})}),n.son("a.fontpg").on("click",function(){return c(this)?!0:void $(this).menu_show(e.jmenu.son("div.fontpg"),0,800)}),r.son("div.fontpg").son("a").click(function(){var t=$(this).attr("title");e.range_restore(),e.set_fontpg(t)}),n.son("a.fontsize").on("click",function(){return c(this)?!0:void $(this).menu_show(e.jmenu.son("div.fontsize"),0,800)}),r.son("div.fontsize").son("a").click(function(){var t=$(this).attr("title");e.range_restore(),e.set_fontsize(t)}),n.son("a.fontcolor").on("click",function(){return c(this)?!0:void $(this).menu_show(e.jmenu.son("div.fontcolor"),0,800)}),r.son("div.fontcolor").son("a").click(function(){var t=$(this).attr("title");e.range_restore(),e.set_fontcolor(t)}),n.son("a.html").on("click",function(){if(c(this))return!0;var t=$(this);t.hasClass("checked")?e.switch_mode(!0):e.switch_mode(!1)}),n.son("a.link").on("click",function(){return c(this)?!0:void e.link_dialog()}),n.son("a.unlink").on("click",function(){return c()?!0:void e.link_clear()}),n.son("a.fullscreen").on("click",function(){return c(this)?!0:void e.fullscreen()}),n.son("a.brush").on("click",function(){return c(this)?!0:void document.execCommand("removeFormat",!1,"")}),n.son("a.insertcode").on("click",function(){return c(this)?!0:void e.paste('<br><pre class="brush: js"></pre><br>')});var p=r.son("div.table").find("td");n.son("a.table").on("click",function(){return c(this)?!0:void $(this).menu_show(e.jmenu.son("div.table"),7,800)}),r.son("div.table").find("td").off("mouseover").on("mouseover",function(){var t=this;p.each(function(e,o){o.cellIndex<=t.cellIndex&&o.parentNode.rowIndex<=t.parentNode.rowIndex?$(o).addClass("checked"):$(o).removeClass("checked")})}),r.son("div.table").find("td").off("click").on("click",function(){for(var t=this.parentNode.rowIndex+1,o=this.cellIndex+1,a=Math.floor((e.width-21)/o),i='<table class="tborder" width="'+(e.width-21)+'">',n=0;t>n;n++){i+="<tr>";for(var r=0;o>r;r++)i+='<td width="'+a+'">&nbsp;</td>';i+="</tr>"}i+="</table>",e.paste(i),e.menu_hide()}),t.in_mobile&&(n.son("a").hide(),n.son("a.undo").show(),n.son("a.redo").show(),n.son("a.bold").show(),n.son("a.file").show(),n.son("a.html").show(),n.son("a.image").show(),n.son("a.fullscreen").show()),$(document).on("click.editor_"+this.jtextarea.attr("id"),function(){e.last_jpopover&&!e.cancel_bubble&&(e.last_jpopover.removeDeep(),e.last_jpopover=null),e.cancel_bubble=!1}),s.on("click",function(t){var o=t.target;is_ie_10||(1==o.nodeType&&"IMG"==o.tagName?e.node_add_resize(o):e.node_remove_resize(o));var a=e.get_parent_nodes(o);a.push(o);var i=$.map(a,function(t){return t.tagName});-1!=$.inArray("TABLE",i)?n.son("a.table").addClass("disabled"):n.son("a.table").removeClass("disabled"),-1!=$.inArray("PRE",i)?n.son("a.insertcode").addClass("disabled"):n.son("a.insertcode").removeClass("disabled");var r=$.inArray("A",i);if(-1!=r){var d=a[r];if(-1!=$.inArray("IMG",i),e.cancel_bubble=!1,"popover color_yellow"!=d.parentNode.className){e.last_jpopover&&e.last_jpopover.removeDeep();var l=$(d);l.popover('链接：<a href="'+d.href+'" target="_blank" class="grey">'+d.href.substr(0,30)+(d.href.length>30?"...":"")+'</a>　<a href="javascript:void(0)" class="modify yellow" style="cursor: pointer" class="">修改</a>　<a href="javascript:void(0)" class="clear yellow" style="cursor: pointer">清除</a>',"bottom","color_yellow");var c=l.jpopover;e.range_save(),c.insertAfter(s),c.son("a.modify").one("click",function(){return e.range_restore(),e.link_dialog(),e.last_jpopover=null,c.removeDeep(),!1}),c.son("a.clear").one("click",function(){return e.link_clear(),e.last_jpopover=null,c.removeDeep(),!1}),e.last_jpopover=c,e.cancel_bubble=!0}}e.set_toolbar()}),s.on("contextmenu",function(t){var o=t.target,a=e.get_parent_nodes(o);a.push(o);var i=$.map(a,function(t){return t.tagName}),n=$.inArray("PRE",i);if(-1!=n){var r=a[n],s=e.context_menu_code_show(t),d=function(){var t=r.className;if(-1!=t.indexOf(":")){var e=t.split(":"),o=$.trim(e[1]);s.son("ul").son("li").removeClass(),s.son("ul").son('li[value="'+o+'"]').addClass("active")}};return d(),s.son("ul").son("li").off("click").on("click",function(){var t=$(this),e=t.attr("value");d(),jpre=$(r),jpre.removeClass().addClass("brush: "+e)}),!1}var l=$.inArray("TD",i);if(-1!=l){var c=$.inArray("TR",i),p=$.inArray("TABLE",i),h=a[l],u=a[c],f=a[p],v=(h.parentNode.rowIndex+1,h.cellIndex+1),g=$(f),m=$(u),s=e.context_menu_table_show(t);return s.son("ul").son("li").eq(0).off("click").on("click",function(){var t=m.clone().insertAfter(m);t.son("td").map(function(){$(this).html("<br>")})}),s.son("ul").son("li").eq(1).off("click").on("click",function(){g.find("tr").map(function(){var t=$(this),e=t.son("td").eq(v-1),o=e.clone().html("<br>");o.insertAfter(e)})}),s.son("ul").son("li").eq(2).off("click").on("click",function(){m.removeDeep()}),s.son("ul").son("li").eq(3).off("click").on("click",function(){g.find("tr").map(function(){var t=$(this),e=t.son("td").eq(v-1);e.removeDeep()})}),!1}return!0}),s.on("keyup input",function(t){e.history(!0)}),s.on("keydown",function(t){var o=t.keyCode?t.keyCode:t.which?t.which:t.charCode;if(9!=o){if(13==o){var a=window.getSelection(),i=a.getRangeAt(0);if(e.has_parent_tag(i.commonAncestorContainer,"PRE"))return e.range_save(),e.paste("\r\n"),!1;if("P"!=i.commonAncestorContainer.tagName){return!0}return!0}return 9!=o}var a=window.getSelection(),i=a.getRangeAt(0);return e.has_parent_tag(i.commonAncestorContainer,"PRE")?(e.range_save(),e.paste("	"),!1):void 0}),s.on("paste",function(t){function o(t){var o=is_ie_10?t:t.getAsFile(),a=new FileReader;a.onload=function(t){var o=new Image,a=t.target.result;if(o.src=a,"data:image"==substr(a,0,10)){var i=a.substring(a.indexOf(",")+1),n={name:"screen_capture_"+time()+".jpg",width:o.width,height:o.height,data:i};$.xpost(e.args.image_upload_url,{upfile:json_encode(n)},function(t,o){if(0==t){var a='<img src="'+o.url+'" width="'+o.width+'" height="'+o.height+'" />';e.range_save(),e.paste(a)}else alert(o)})}},a.readAsDataURL(o)}var a=t.clipboardData||window.clipboardData;if(a){if(is_ie_10)i=a.files.item(0);else{for(var i=null,n=a.items||[],r=a.types||[],s=0;s<r.length;s++)if("Files"==r[s]){i=n[s];break}is_ff&&(i=n[0])}if(i&&i.type.match(/^image\//i))return o(i),!1;var d=a.getData(is_ie_10?"Text":"text/html");if(d&&d.length>0){-1!=d.indexOf("<!--StartFragment-->")&&-1!=d.indexOf("<!--EndFragment-->")&&(d=d.substring(d.indexOf("<!--StartFragment-->")+20,d.indexOf("<!--EndFragment-->")));var l=e.clear_officeword(d);l&&l!=d&&a.setData("text/html",l)}return d?(e.range_save(),e.paste(d),!1):void setTimeout(function(){e.pdata_save()},200)}}),this.jtextareaclone.on("paste keyup",function(){e.pdata_save(this.value)});var h=this.jtextarea.val();h?s.html(h):e.pdata_load(),e.focus(),e.init_file_upload()},$.XNEditor.prototype.width=null,$.XNEditor.prototype.height=null,$.XNEditor.prototype.jclone=null,$.XNEditor.prototype.jtextarea=null,$.XNEditor.prototype.jtextareaclone=null,$.XNEditor.prototype.jeditor=null,$.XNEditor.prototype.jtoolbar=null,$.XNEditor.prototype.jmenu=null,$.XNEditor.prototype.jbody=null,$.XNEditor.prototype.jfooter=null,$.XNEditor.prototype.jtmp=null,$.XNEditor.prototype.issource=!1,$.XNEditor.prototype.last_range=null,$.XNEditor.prototype.last_jpopover=null,$.XNEditor.prototype.cancel_bubble=!1,$.XNEditor.prototype.history_arr=[],$.XNEditor.prototype.history_index=-1,$.XNEditor.prototype.history_last_time=0,$.XNEditor.prototype.args=null,$.XNEditor.prototype.file_upload=null,$.XNEditor.prototype.image_upload=null,$.XNEditor.prototype.jlink=null,$.XNEditor.prototype.close=function(){$(document).off(".editor_"+this.jtextarea.attr("id")),this.clear(),this.file_upload=null,this.image_upload=null,this.jlink&&this.jlink.dialog&&this.jlink.dialog("destory"),this.jmenu.son("div.fileupload")[0].dialog&&this.jmenu.son("div.fileupload").dialog("destory"),this.jmenu.son("div.imageupload")[0].dialog&&this.jmenu.son("div.imageupload").dialog("destory"),this.jeditor.removeDeep()},$.XNEditor.prototype.execCommand=function(t,e,o){e||(e=!1),o||(o=null),document.execCommand(t,e,o),this.set_toolbar(),this.history()},$.XNEditor.prototype.format_html=function(){var t=this.jbody,e=font_tag_to_span(t.html());t.html(e),t[0].clearSpanNodeDeep(),t[0].spanToBIUDeep()},$.XNEditor.prototype.clear=function(){this.set_body(""),this.history_arr=[],this.history_index=-1,this.history_last_time=0,this.pdata_clear()},$.XNEditor.prototype.set_body=function(t){console.log("set_body: %s",t);var e=this.jbody,o=this.jtextarea,a=this.jtextareaclone;e.html(t),o.val(t),a.val(t)},$.XNEditor.prototype.set_width=function(){},$.XNEditor.prototype.history=function(t){var e=this.jbody.html(),o=this.jtoolbar,a=this.jbody,i=(this.history_arr,this.history_index),n=this;t&&t!==!0?1===t?i<this.history_arr.length-1&&(i++,a.html(this.history_arr[i])):-1===t&&i>=0&&(i--,o.son("a.undo").removeClass("disabled"),o.son("a.redo").removeClass("disabled"),a.html(this.history_arr[i])):(this.history_saved=!1,Date.now()-this.history_last_time>=2e3?((-1==i||i>-1&&this.history_arr[i]!=e)&&(this.history_arr.length>=30&&(this.history_arr=this.history_arr.slice(10,this.history_arr.length),this.history_arr.length=20,i=19),o.son("a.undo").removeClass("disabled"),i++,this.history_arr[i]=e,this.history_arr.length=i+1,this.history_saved=!0),this.history_last_time=Date.now()):(this.history_t&&clearTimeout(this.history_t),this.history_t=setTimeout(function(){n.history(!0)},2e3)),t!==!0||this.history_saved||(this.history_arr[i]=e)),i>=this.history_arr.length-1?o.son("a.redo").addClass("disabled"):o.son("a.redo").removeClass("disabled"),0>i?o.son("a.undo").addClass("disabled"):o.son("a.undo").removeClass("disabled"),this.history_index=i,this.pdata_save()},$.XNEditor.prototype.pdata_save=function(t){t||(t=this.jbody.html()),this.jtextarea.val(t),this.jtextareaclone.val(t),$.pdata("xneditor_pdata_"+this.jtextarea.attr("id"),t)},$.XNEditor.prototype.pdata_load=function(){var t=$.pdata("xneditor_pdata_"+this.jtextarea.attr("id"));t&&"<p><br></p>"!=t&&(this.jbody.html(t),this.jtextarea.val(t),this.jtextareaclone.val(t))},$.XNEditor.prototype.pdata_clear=function(){$.pdata("xneditor_pdata_"+this.jtextarea.attr("id"),"")},$.XNEditor.prototype.switch_mode=function(t){var e=(this.jtextarea,this.jtextareaclone),o=this.jtoolbar,a=this.jbody,i=o.son("a.html");if(t){e.hide();var n=e.val();a.html(n),this.format_html(),a.show(),this.range_restore(),this.focus(),i.removeClass("checked"),o.son().not(i).not("a.fullscreen").removeClass("disabled")}else{this.range_save(),a.hide();var n=$.trim(a.html());e.val(n),e.show().focus(),i.addClass("checked"),o.son().not(i).not("a.fullscreen").addClass("disabled")}this.pdata_save()},$.XNEditor.prototype.fullscreen=function(t){var e=this.jeditor,o=(this.jtextarea,this.jtextareaclone),a=this.jtoolbar,i=this.jbody,n=a.son("a.fullscreen");if(n.hasClass("checked")){e.insertBefore(this.jtmp).css("z-index",0),this.jtmp.removeDeep(),this.jtmp=null,$(document.body).css("overflow","auto");var r=this.width,s=this.height;e.css({position:"relative",left:"auto",top:"auto"}),e.width(r),e.height(s+a.height()),i.width(r-2),i.height(s-2),o.width(r).height(s-4),n.removeClass("checked")}else{this.jtmp||(this.jtmp=$("<span></span>").insertAfter(e)),e.appendTo(document.body).css("z-index",2e3),$(document.body).css("overflow","hidden");var r=$(window).width(),s=$(window).height();e.css({position:"absolute",left:"0px",top:"0px"}),e.width(r),e.height(s),i.width(r-22),i.height(s-a.height()),o.width(r-2).height(s-a.height()-2).css("overflow","auto"),n.addClass("checked")}this.range_restore()},$.XNEditor.prototype.focus=function(){var t=this;setTimeout(function(){t.range_create()},100)},$.XNEditor.prototype.range_create=function(){var t=this.jbody[0];window.focus();var e=window.getSelection(),o=document.createRange();if(t.lastChild||t.appendChild(document.createElement("p")),o.selectNode(t.lastChild),"P"==t.lastChild.tagName){if(t.lastChild.lastChild&&"BR"==t.lastChild.lastChild.tagName)a=t.lastChild.lastChild;else{var a=document.createElement("br");t.lastChild.appendChild(a)}o.setStartAfter(a),o.setEndAfter(a),is_ie_10&&t.lastChild.removeChild(a)}else o.selectNode(t.lastChild),o.collapse(!1);return e.removeAllRanges(),e.addRange(o),t.style.outline="0",o},$.XNEditor.prototype.range_select=function(t){window.focus();var e=window.getSelection(),o=document.createRange();return o.selectNode(t),e.removeAllRanges(),e.addRange(o),t.style.outline="0",o},$.XNEditor.prototype.paste=function(t,e){t=this.clear_officeword(t);var o=window.getSelection(),a=this.last_range;a&&a.isChildOf(this.jbody[0])||(a=this.range_create());var i=document.createElement("div");i.innerHTML=t,this.has_parent_tag(a.commonAncestorContainer,"PRE")&&i.firstChild&&"PRE"==i.firstChild.tagName&&i.firstChild.removeAndMoveUpChildren();for(var n=!1,r=0;r<i.childNodes.length;r++)if(-1!="_TABLE_DIV_UL_DL_".indexOf("_"+i.childNodes[r].tagName+"_")){n=!0;break}if(n){var s=a.commonAncestorContainer,d=3==s.nodeType?s.parentNode:s;if(-1!="_P_H1_H2_H3_H4_H5_H6_SPAN_B_I_U_".indexOf("_"+d.tagName+"_")){var l=null,c=d.getParentNodes(this.jbody[0]);c.push(d);for(var p=["P","H1","H2","H3","H4","H5","H6","SPAN","B","I","U","STRONG","EM"],h=0;h<c.length;h++)for(var r=0;r<p.length;r++)if(c[h].tagName==p[r]){l=c[h];break}var u=document.createRange();u.setStartBefore(l),u.setEnd(a.startContainer,a.startOffset);var f=document.createRange();f.setStart(a.endContainer,a.endOffset),f.setEndAfter(l);var v=u.cloneContents(),g=f.cloneContents();d.parentNode.insertBefore(v,d);var m=document.createElement("br");d.parentNode.insertBefore(m,d),d.parentNode.insertBefore(g,d),a.selectNode(m),d.parentNode.removeChild(d)}}a.deleteContents();for(var y=i.lastChild;i.childNodes.length>0;)a.insertNode(i.childNodes[i.childNodes.length-1]);o.addRange(a),o.removeAllRanges();var F=document.createRange();F.selectNode(y),F.collapse(!1),o.addRange(F),this.history()},$.XNEditor.prototype.range_restore=function(){var t=window.getSelection();this.last_range&&(t.removeAllRanges(),t.addRange(this.last_range))},$.XNEditor.prototype.range_save=function(){var t=window.getSelection();t.getRangeAt&&t.rangeCount&&"SCRIPT"!=t.anchorNode.nodeName?this.last_range=t.getRangeAt(0):this.last_range=null},$.XNEditor.prototype.range_select_node=function(t){},$.XNEditor.prototype.menu_hide=function(){this.jmenu.son("div").not(this.jmenu.son("div.upload")).hide()},$.XNEditor.prototype.set_fontcolor=function(t){"清除"==t?document.execCommand("removeFormat",!1,"foreColor"):this.execCommand("ForeColor",!1,t),this.jtoolbar.son("a.fontcolor").css("background-color",t),this.jmenu.son("div.fontcolor").hide()},$.XNEditor.prototype.set_fontsize=function(t){this.execCommand("fontsize",!1,t),this.jmenu.son("div.fontsize").hide()},$.XNEditor.prototype.set_fontpg=function(t){this.execCommand("formatblock",!1,"<h"+t+">"),this.jmenu.son("div.fontpg").hide()},$.XNEditor.prototype.link_dialog=function(){var t=this,e=this.jlink?this.jlink:t.jmenu.son("div.link");this.jlink=e;var o=e.find('input[name="url"]'),a=e.find('input[name="text"]'),i=e.find("button.confirm"),n=e.find("button.cancel");e.dialog({model:!0,open:!0,zindex:3e3}),o.val(""),a.val("");var r=!1,s=!1,d=null,l=t.last_range;if(l){var c=l.startContainer,p=$(c).closest("a")[0];if(p){var h=p?p.href:"http://",u=p.innerText?p.innerText:h;o.val(h),a.val(u),r=!0}else{var u=l.cloneContents().textContent;a.val(u)}}var f=l.cloneContents();f.firstChild&&"IMG"==f.firstChild.tagName&&(s=!0,d=l.startContainer.childNodes[l.startOffset]),r||s?e.find("p").eq(1).hide():e.find("p").eq(1).show(),o.focus(),i.off("click").on("click",function(){var i=a.val()?a.val():o.val();if(s&&!r){var n=$('<a href="'+o.val()+'" target="_blank"></a>').insertBefore(d);n.append(d)}else r?p.href=o.val():o.val()&&t.paste('<a href="'+o.val()+'" target="_blank">'+i+"</a>");e.dialog("close")}),n.off("click").on("click",function(){e.dialog("close")})},$.XNEditor.prototype.link_clear=function(){var t=this,e=t.last_range;if(e){var o=e.startContainer,a=$(o).closest("a")[0];a&&a.removeAndMoveUpChildren()}},$.XNEditor.prototype.set_toolbar=function(t){for(var e=new Array("bold","italic","underline","justifyleft","justifycenter","justifyright"),o=0;o<e.length;o++)try{var a=document.queryCommandState(e[o]);this.jtoolbar.son("a."+e[o]).toggleClass("checked",a)}catch(i){}for(var e=new Array("fontsize","forecolor","formatblock"),o=0;o<e.length;o++){try{var n=document.queryCommandValue(e[o])}catch(i){continue}if("forecolor"==e[o])n=color_format(n),this.jtoolbar.son("a.fontcolor").css("background-color",n);else if("fontsize"==e[o])r=parseInt(n),r=font_size_format(r),r=r.replace(/px/gi,"像素"),this.jtoolbar.son("a.fontsize").html(r?r:"字号");else if("formatblock"==e[o]){var r="";switch(n){case"h1":r=1;break;case"h2":r=2;break;case"h3":r=3;break;case"h4":r=4;break;case"h5":r=5;break;case"h6":r=6}this.jtoolbar.son("a.fontpg").html(r?"H"+r:"标题")}}},$.XNEditor.prototype.init_image_upload=function(){var t=this,e=this.args.image_upload_url,o=this.jtoolbar.son("a.image").son("input")[0],a=this.jtoolbar.closest("form"),i=a.length>0?a.serializeObj():"";this.image_upload=new FileUploader(o,e,i),this.image_upload.thumb_width=this.args.image_upload_width||800;var n=t.jmenu.son("div.imageupload");this.image_upload.onprogress=function(t,e){t.jli;t.jli.son("span._progress_current").width(e+"%")},this.image_upload.ononce=function(t,e){console.log("file: %o",t);var o=t.jli,a=json_decode(e.target.response);if(a&&0==a.code)o[0].message=a.message;else{var i=a&&a.message?a.message:e.target.response;o.removeClass("checked").son("span._error").show().son("span").text(i)}o.son("span._trash").on("click",function(){return o.removeDeep(),!1}).show()},this.image_upload.oncomplete=function(t,e){n.find("button.confirm").show()},this.image_upload.onselected=function(e){var o=n.find("ul");n.dialog({title:"上传图片",modal:!0,open:!0,zindex:3e3}),o.son("li").not("li.clone").removeDeep();var a=o.son("li").eq(0).hide().clone().removeClass("clone").show();$.each(e,function(){var t=this;if(!/^image/.test(t.type)||!/(.jpg|.jpeg|.gif|.png|.bmp)$/i.test(t.type))return void e.son("span._error").son("span").text("只允许上传jpg、jpeg、gif、png格式的图片");if(t.size>1012e4)return void e.son("span._error").son("span").text("图片不能超过10M");var e=a.clone().appendTo(o).addClass("checked");t.jli=e,e.son("span._content").son("img").srcLocalFile(t),e.son("span._progress_title").text(t.name.substr(0,13)),e.on("click",function(){var t=e.son("span._error").son("span").text();t||$(this).toggleClass("checked")}),e.son("span._trash").hide(),e.son("span._error").hide()}),console.log("onselect: %o",e),n.find("button.confirm").hide().off("click").on("click",function(){var e="";o.son("li").each(function(){this.message&&$(this).hasClass("checked")&&(e+='<img src="'+parent.CAICUI.Common.host["static"]+this.message.url+'" width="'+this.message.width+'" height="'+this.message.height+'" />')}),e&&t.paste(e),n.dialog("close")}),n.find("button.cancel").off("click").on("click",function(){n.dialog("close")}),t.image_upload.start()},this.image_upload.onerror=function(t,e){var o=t.jli,a=json_decode(e.target.response),i=a&&a.message?a.message:e.target.response;o.son("span._error").show().son("i").text(i)},this.image_upload.onabort=function(t,e){},this.image_upload.init()},$.XNEditor.prototype.init_file_upload=function(){var t=this,e=this.args.file_upload_url,o=this.jtoolbar.son("a.file").son("input")[0],a=this.jtoolbar.closest("form"),i=a.length>0?a.serializeObj():"";this.file_upload=new FileUploader(o,e,i);var n=t.jmenu.son("div.fileupload");this.file_upload.onprogress=function(t,e){t.jli;t.jli.son("span._progress_current").width(e+"%")},this.file_upload.ononce=function(t,e){var o=t.jli,a=json_decode(e.target.response);if(a&&0==a.code)o[0].message=a.message;else{var i=a&&a.message?a.message:e.target.response;o.removeClass("checked").son("span._error").show().son("span").text(i)}o.son("span._trash").on("click",function(){return o.removeDeep(),!1}).show()},this.file_upload.onselected=function(e){var o=n.find("ul");n.dialog({title:"上传文件",modal:!0,open:!0,zindex:3e3}),o.son("li").not("li.clone").removeDeep();for(var a=o.son("li").eq(0).hide().clone().removeClass("clone").show(),i=0;i<e.length;i++)+function(t){var i=e[t];if(i.size>1012e4)return void n.son("span._error").son("span").text("文件不能超过10M");var n=a.clone().appendTo(o).addClass("checked");i.jli=n;var r=file_type(file_suffix(i.name));"image"==r?n.son("span._content").son("img").srcLocalFile(i):n.son("span._content").html('<i class="icon filetype '+r+'"></i>'),n.son("span._progress_title").text(i.name.substr(0,13)),n.on("click",function(){var t=n.son("span._error").son("span").text();t||$(this).toggleClass("checked")}),n.son("span._trash").hide(),n.son("span._error").hide();
}(i);n.find("button.confirm").hide().off("click").on("click",function(){var e="";o.son("li").each(function(){this.message&&$(this).hasClass("checked")&&(e+=' <a href="'+this.message.url+'" target="_blank"><i class="icon filetype small '+file_type(file_suffix(this.message.name))+'"></i>'+this.message.name+"</a> ")}),e&&t.paste(e+"&nbsp; "),n.dialog("close")}),n.find("button.cancel").off("click").on("click",function(){n.dialog("close")}),t.file_upload.start()},this.file_upload.oncomplete=function(t,e){n.find("button.confirm").show()},this.file_upload.onerror=function(t,e){var o=t.jli,a=json_decode(e.target.response),i=a&&a.message?a.message:e.target.response;o.son("span._error").show().son("i").text(i)},this.file_upload.onabort=function(t,e){},this.file_upload.init()},$.XNEditor.prototype.get_parent_nodes=function(t){return t?t.getParentNodes(this.jbody[0]):[]},$.XNEditor.prototype.has_parent_tag=function(t,e,o){return HTMLElement.prototype.hasParentTag.call(t,e,o)},$.XNEditor.prototype.node_add_resize=function(t){var e=this.jbody,o=this.jeditor,a=this.jmenu,i=a.son("div.resize"),n=$(t),r=n.position(),s=n.offsetParent(),d=s.offset(),l=r.left,c=r.top,p=n.width(),h=n.height();this.last_range=this.range_select(t);var u=function(t,e,o,a){i.width(o+2).height(a+2).css("left",t+"px").css("top",e+"px"),t=0,e=0,i.son("span").eq(0).css("left",t-3+"px").css("top",e-3+"px"),i.son("span").eq(1).css("left",t+(o+2)/2-3+"px").css("top",e-3+"px"),i.son("span").eq(2).css("left",t+(o+2)-3+"px").css("top",e-3+"px"),i.son("span").eq(3).css("left",t-3+"px").css("top",e+(a+2)/2-3+"px"),i.son("span").eq(4).css("left",t+(o+2)-3+"px").css("top",e+(a+2)/2-3+"px"),i.son("span").eq(5).css("left",t-3+"px").css("top",e+(a+2)-3+"px"),i.son("span").eq(6).css("left",t+(o+2)/2-3+"px").css("top",e+(a+2)-3+"px"),i.son("span").eq(7).css("left",t+(o+2)-3+"px").css("top",e+(a+2)-3+"px")};u(l,c,p,h),i.on("mousedown",function(){i.hide()}),n.add(i).add(i.son("span")).on("drag",function(){return!1}),i.son("span").eq(4).off("mousedown").on("mousedown",function(){return e.add(i).off("mousemove").on("mousemove",function(t){var e=t.pageX-l-d.left;return e>10&&(p=e,n.width(e),n.height(h),u(l,c,p,h)),!0}),o.son("div.popover").hide(),!1}),i.son("span").eq(6).off("mousedown").on("mousedown",function(){return e.add(i).off("mousemove").on("mousemove",function(t){var e=t.pageY-c-d.top;return e>10&&(h=e,n.width(p),n.height(h),u(l,c,p,h)),!0}),o.son("div.popover").hide(),!1}),i.son("span").eq(7).off("mousedown").on("mousedown",function(){return e.add(i).off("mousemove").on("mousemove",function(t){var e=t.pageX-l-d.left;t.pageY-c-d.top;return p>10&&h>10&&(h=e/p*h,p=e,n.width(p),n.height(h),u(l,c,p,h)),!0}),o.son("div.popover").hide(),!1});i.off("mouseup").on("mouseup",function(){return e.add(i).off("mousemove"),!1}),$(document).off("mouseup.editor_"+this.jtextarea.attr("id")).on("mouseup.editor_"+this.jtextarea.attr("id"),function(){return e.add(i).off("mousemove"),!1}),e.on("scroll",function(t){var o=a.son("div.resize");o.hide(),e.off("scroll")}),i.show()},$.XNEditor.prototype.node_remove_resize=function(t){var e=(this.jbody,this.jeditor,this.jmenu.son("div.resize"));$(t);e.hide()},$.XNEditor.prototype.context_menu_table_show=function(t){var e=this,o=this.jmenu.offsetParent(),a=o.offset(),i=this.jmenu.son("div.context_menu_table");return i.css({position:"absolute",top:t.pageY-a.top+"px",left:t.pageX-a.left+"px","z-index":3e3}).show(),$(document).one("click.editor_"+this.jtextarea.attr("id"),function(){e.context_menu_table_hide()}),i},$.XNEditor.prototype.context_menu_table_hide=function(){var t=this.jmenu.son("div.context_menu_table");t.hide()},$.XNEditor.prototype.context_menu_code_show=function(t){var e=this,o=this.jmenu.offsetParent(),a=o.offset(),i=this.jmenu.son("div.context_menu_code");return i.css({position:"absolute",top:t.pageY-a.top+"px",left:t.pageX-a.left+"px","z-index":3e3}).show(),$(document).one("click.editor_"+this.jtextarea.attr("id"),function(){e.context_menu_code_hide()}),i},$.XNEditor.prototype.context_menu_code_hide=function(){var t=this.jmenu.son("div.context_menu_code");t.hide()},$.XNEditor.prototype.clear_officeword=function(t){if(t.match(/mso-cellspacing:/i)||t.match(/<v|o:\w+/i)||t.match(/<w:WordDocument>/i)||t.match(/<!{1}--\[if gte mso \d+\]>/i)){var e=["table","tbody","tr","td","th","div","p","br","a","img","h1","h2","h3","h4","h5","hr"],o=["width","height","href","src","align","border","cellspaceing","cellspadding","border"];t=t.replace(/<!.*?>/gim,""),t=t.replace(/<style[^>]*>[\s\S]+?<\/style>/gi,""),t=t.replace(/<xml[^>]*>[\s\S]+?<\/xml>/gi,""),t=t.replace(/\s+/gi," "),t=t.replace(/<([\w\-:]+)\s*([^>]*)>/gi,function(t,a,i){return a=a.toLowerCase(),-1==$.inArray(a,e)?"":(i=$.trim(i),i=i.replace(/(\w+)\s*=\s*['"]?([^'"]*)['"]?/gi,function(t,e,a){return e=$.trim(e.toLowerCase()),-1==$.inArray(e,o)?"":"border"==e?'border="1"':t}),i=$.trim(i),"<"+a+(i?" ":"")+i+">")}),t=t.replace(/<\/([\w\-:]+)\s*>/gi,function(t,o){return-1==$.inArray(o,e)?"":t})}return t=this.clear_code(t)},$.XNEditor.prototype.clear_code=function(t){return t=t.replace(/<code([^>]*)>(.*?)<\/code>/gi,function(t,e,o){return"<code>"+o+"</code>"})},$.XNEditor.prototype.global_init=function(){var t='<div class="editor" style="display: none;">			<div class="toolbar">				<a style="display:none;" class="html" href="javascript:void(0)" title="HTML 源代码"></a>				<a style="display:none;" class="undo disabled" href="javascript:void(0)" title="上一步"></a>				<a style="display:none;" class="redo disabled" href="javascript:void(0)" title="下一步"></a>				<a class="bold" href="javascript:void(0)" title="加粗"></a>				<a class="italic" href="javascript:void(0)" title="倾斜"></a>				<a class="underline" href="javascript:void(0)" title="下划线"></a>				<a style="display:none;" class="fontpg" href="javascript:void(0)">标题</a>				<a style="display:none;" class="fontsize" href="javascript:void(0)">字号</a>				<a class="fontcolor" href="javascript:void(0)" title="字体颜色"></a>				<a style="display:none;" class="link" href="javascript:void(0)" title="超链接"></a>				<a style="display:none;" class="unlink" href="javascript:void(0)" title="去除超链接"></a>				<a style="display:none;" class="justifyleft" href="javascript:void(0)" title="左对齐"></a>				<a style="display:none;" class="justifycenter" href="javascript:void(0)" title="居中对齐"></a>				<a style="display:none;" class="justifyright" href="javascript:void(0)" title="右对齐"></a>				<a style="display:none;" class="justifyfull" href="javascript:void(0)"></a>				<a class="image" href="javascript:void(0)" title="上传图片"><form id= "uploadForm" class="add-photo-form" enctype="multipart/form-data"> <input type="hidden" name="filename" value= "upfile"/><input type="hidden" id="uploadForm-token" name="token" value= ""/><input type="file" id="uploadForm-file" class="uploadForm-file" name="file" accept="image/gif,image/png,image/jpg,image/jpeg"/></form></a>				<a style="display:none;" class="file" href="javascript:void(0)" title="上传文件"><input type="file" multiple="multiple" /></a>				<a style="display:none;" class="brush" href="javascript:void(0)" title="清除格式"></a>				<a style="display:none;" class="insertcode" href="javascript:void(0)" title="插入代码"></a>				<a style="display:none;" class="table" href="javascript:void(0)" title="插入表格"></a>				<a style="display:none;" class="fullscreen" href="javascript:void(0)" title="全屏"></a>							</div>			<div class="body" contenteditable="true" spellcheck="false"><p></p></div>			<div class="footer">			</div>			<div class="menu">				<div class="fontpg">					<a title="1" href="javascript: void(0)"><h1>H1</h1></a>					<a title="2" href="javascript: void(0)"><h2>H2</h2></a>					<a title="3" href="javascript: void(0)"><h3>H3</h3></a>					<a title="4" href="javascript: void(0)"><h4>H4</h4></a>					<a title="5" href="javascript: void(0)"><h5>H5</h5></a>					<a title="6" href="javascript: void(0)"><h6>H6</h6></a>				</div>				<div class="fontsize">					<a title="1" href="javascript: void(0)" style="font-size: 12px;">12像素</a>					<a title="2" href="javascript: void(0)" style="font-size: 13px;">13像素</a>					<a title="3" href="javascript: void(0)" style="font-size: 16px;">16像素</a>					<a title="4" href="javascript: void(0)" style="font-size: 18px;">18像素</a>					<a title="5" href="javascript: void(0)" style="font-size: 24px;">24像素</a>					<a title="6" href="javascript: void(0)" style="font-size: 32px;">32像素</a>					<a title="7" href="javascript: void(0)" style="font-size: 48px;">48像素</a>				</div>				<div class="fontcolor">					<a href="javascript: void(0)" title="清除" style="background: #FFFFFF; width: 165px; height: 19px; font-size: 12px; line-height: 19px; text-align: center; padding-left: 0px;">清除</a>					<a href="javascript: void(0)" title="#FFFFFF" style="background: #FFFFFF;"></a>					<a href="javascript: void(0)" title="#CCCCCC" style="background: #CCCCCC;"></a>					<a href="javascript: void(0)" title="#C0C0C0" style="background: #C0C0C0;"></a>					<a href="javascript: void(0)" title="#999999" style="background: #999999;"></a>					<a href="javascript: void(0)" title="#666666" style="background: #666666;"></a>					<a href="javascript: void(0)" title="#333333" style="background: #333333;"></a>					<a href="javascript: void(0)" title="#000000" style="background: #000000;"></a>					<a href="javascript: void(0)" title="#FFCCCC" style="background: #FFCCCC;"></a>					<a href="javascript: void(0)" title="#FF6666" style="background: #FF6666;"></a>					<a href="javascript: void(0)" title="#FF0000" style="background: #FF0000;"></a>					<a href="javascript: void(0)" title="#CC0000" style="background: #CC0000;"></a>					<a href="javascript: void(0)" title="#990000" style="background: #990000;"></a>					<a href="javascript: void(0)" title="#660000" style="background: #660000;"></a>					<a href="javascript: void(0)" title="#330000" style="background: #330000;"></a>					<a href="javascript: void(0)" title="#FFCC99" style="background: #FFCC99;"></a>					<a href="javascript: void(0)" title="#FF9966" style="background: #FF9966;"></a>					<a href="javascript: void(0)" title="#FF9900" style="background: #FF9900;"></a>					<a href="javascript: void(0)" title="#FF6600" style="background: #FF6600;"></a>					<a href="javascript: void(0)" title="#CC6600" style="background: #CC6600;"></a>					<a href="javascript: void(0)" title="#993300" style="background: #993300;"></a>					<a href="javascript: void(0)" title="#663300" style="background: #663300;"></a>					<a href="javascript: void(0)" title="#FFFF99" style="background: #FFFF99;"></a>					<a href="javascript: void(0)" title="#FFFF66" style="background: #FFFF66;"></a>					<a href="javascript: void(0)" title="#FFCC66" style="background: #FFCC66;"></a>					<a href="javascript: void(0)" title="#FFCC33" style="background: #FFCC33;"></a>					<a href="javascript: void(0)" title="#CC9933" style="background: #CC9933;"></a>					<a href="javascript: void(0)" title="#996633" style="background: #996633;"></a>					<a href="javascript: void(0)" title="#663333" style="background: #663333;"></a>					<a href="javascript: void(0)" title="#FFFFCC" style="background: #FFFFCC;"></a>					<a href="javascript: void(0)" title="#FFFF33" style="background: #FFFF33;"></a>					<a href="javascript: void(0)" title="#FFFF00" style="background: #FFFF00;"></a>					<a href="javascript: void(0)" title="#FFCC00" style="background: #FFCC00;"></a>					<a href="javascript: void(0)" title="#999900" style="background: #999900;"></a>					<a href="javascript: void(0)" title="#666600" style="background: #666600;"></a>					<a href="javascript: void(0)" title="#333300" style="background: #333300;"></a>					<a href="javascript: void(0)" title="#99FF99" style="background: #99FF99;"></a>					<a href="javascript: void(0)" title="#66FF99" style="background: #66FF99;"></a>					<a href="javascript: void(0)" title="#33FF33" style="background: #33FF33;"></a>					<a href="javascript: void(0)" title="#33CC00" style="background: #33CC00;"></a>					<a href="javascript: void(0)" title="#009900" style="background: #009900;"></a>					<a href="javascript: void(0)" title="#006600" style="background: #006600;"></a>					<a href="javascript: void(0)" title="#003300" style="background: #003300;"></a>					<a href="javascript: void(0)" title="#99FFFF" style="background: #99FFFF;"></a>					<a href="javascript: void(0)" title="#33FFFF" style="background: #33FFFF;"></a>					<a href="javascript: void(0)" title="#66CCCC" style="background: #66CCCC;"></a>					<a href="javascript: void(0)" title="#00CCCC" style="background: #00CCCC;"></a>					<a href="javascript: void(0)" title="#339999" style="background: #339999;"></a>					<a href="javascript: void(0)" title="#336666" style="background: #336666;"></a>					<a href="javascript: void(0)" title="#003333" style="background: #003333;"></a>					<a href="javascript: void(0)" title="#CCFFFF" style="background: #CCFFFF;"></a>					<a href="javascript: void(0)" title="#66FFFF" style="background: #66FFFF;"></a>					<a href="javascript: void(0)" title="#33CCFF" style="background: #33CCFF;"></a>					<a href="javascript: void(0)" title="#3366FF" style="background: #3366FF;"></a>					<a href="javascript: void(0)" title="#3333FF" style="background: #3333FF;"></a>					<a href="javascript: void(0)" title="#000099" style="background: #000099;"></a>					<a href="javascript: void(0)" title="#000066" style="background: #000066;"></a>					<a href="javascript: void(0)" title="#CCCCFF" style="background: #CCCCFF;"></a>					<a href="javascript: void(0)" title="#9999FF" style="background: #9999FF;"></a>					<a href="javascript: void(0)" title="#6666CC" style="background: #6666CC;"></a>					<a href="javascript: void(0)" title="#6633FF" style="background: #6633FF;"></a>					<a href="javascript: void(0)" title="#6600CC" style="background: #6600CC;"></a>					<a href="javascript: void(0)" title="#333399" style="background: #333399;"></a>					<a href="javascript: void(0)" title="#330099" style="background: #330099;"></a>					<a href="javascript: void(0)" title="#FFCCFF" style="background: #FFCCFF;"></a>					<a href="javascript: void(0)" title="#FF99FF" style="background: #FF99FF;"></a>					<a href="javascript: void(0)" title="#CC66CC" style="background: #CC66CC;"></a>					<a href="javascript: void(0)" title="#CC33CC" style="background: #CC33CC;"></a>					<a href="javascript: void(0)" title="#993399" style="background: #993399;"></a>					<a href="javascript: void(0)" title="#663366" style="background: #663366;"></a>					<a href="javascript: void(0)" title="#330033" style="background: #330033;"></a>				</div>				<div class="imageupload dialog upload">					<ul>						<li class="clone">							<span class="_content"><img src="javascript:void(0)" width="120" height="120" /></span>							<span class="_progress_bg"></span>							<span class="_progress_current"></span>							<span class="_progress_title"></span>							<span class="red _error"><i class="icon close red"></i><span></span></span>							<span class="icon trash _trash"></span>						</li>					</ul>					<p class="center"><button type="button" class="button blue confirm" style="display: none;">确定</button> <button type="button" class="button grey cancel">取消</button></p>				</div>				<div class="fileupload dialog upload">					<ul>						<li class="clone">							<span class="_content"><img src="javascript:void(0)" width="120" height="120" /></span>							<span class="_progress_bg"></span>							<span class="_progress_current"></span>							<span class="_progress_title"></span>							<span class="red _error"><i class="icon close red"></i><span></span></span>							<span class="icon trash _trash"></span>						</li>					</ul>					<p class="center"><button type="button" class="button blue confirm" style="display: none;">确定</button> <button type="button" class="button grey cancel">取消</button></p>				</div>				<div class="link dialog" title="插入链接">					<p>网址：<input type="text" name="url" style="width: 530px; display: inline-block;" placeholder="http://" /></p>					<p>文本：<input type="text" name="text" style="width: 530px; display: inline-block;" placeholder="链接文本" /></p>					<p class="center"><button type="button" class="button blue confirm">确定</button> <button type="button" class="button grey cancel">取消</button></p>				</div>				<div class="table">					<table class="tborder">						<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>						<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>						<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>						<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>						<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>						<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>						<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>						<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>						<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>						<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>						<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>						<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>					</table>				</div>				<div class="resize">					<span class="point0"></span>					<span class="point1"></span>					<span class="point2"></span>					<span class="point3"></span>					<span class="point4"></span>					<span class="point5"></span>					<span class="point6"></span>					<span class="point7"></span>				</div>				<div class="context_menu context_menu_table">					<ul>						<li>增加一行</li>						<li>增加一列</li>						<li>删除当前行</li>						<li>删除当前列</li>					</ul>				</div>				<div class="context_menu context_menu_code">					<ul>						<li value="">无</li>						<li value="js">javascript</li>						<li value="php">PHP</li>						<li value="c">C/C++</li>					</ul>				</div>			</div>		</div>		';this.jclone=$(t).appendTo("body")},$.XNEditor.prototype.global_init();