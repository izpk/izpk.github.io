<script id="template-message-list" type="text/template">
	<div id="scroller-message-list" class="scroller">
		<!-- <div class="message-num">
			<span class="message-total-num">共有信息：<%= data.totalCount %>条</span>
			<span class="message-noread-num">未读信息：<span class="message-isReadNum"><%= CAICUI.render.isNoReadNum %></span>条</span>
		</div> -->
		<% 
			if(data.messageList && data.messageList.length){
		%>
		<ul class="message-list-ul">
			<% _.each(data.messageList,function(element, index, list){ %>
				<li id="message-list-<%= element.id %>" class="message-list-li" data-id="<%= element.id %>" data-type="<%= element.type %>" data-status="<%= element.status %>" data-content='<%= JSON.stringify(list[index]) %>'>
					<div class="message-list-a" >


						<% 
							var titleContent = '';
							var type = 0;
							var typeName = ""
							if(element.msgType == "1" && element.title == "意见反馈"){
								type = 2;
								typeName = "系统";
							}else if(element.msgType == "1" && element.title != "意见反馈"){
								type = 1;
								typeName = "系统";
							}else if(element.msgType == "0"){
								type = 3;
								typeName = "用户";
							}

							

							if(type == 1){
								titleContent = element.title;
							}else if(type == 2){
								titleContent = '<span class="message-unread-title-span">你的投诉收到了回复</span>';
							}else if(type == 3){
								titleContent = '<span class="message-unread-title-span">回复了您的：</span>'+element.title;
							}
							if(element.status == "0"){
								titleContent += '<span class="message-unread-tips">未读</span>';
							}else if(element.status == "1"){

							}
						%>
							<p class="message-unread-title message-unread-title1"><%= titleContent %></p>
						


						<% if(element.content){ %>
						<% 
							var arrEntities={'lt':'<','gt':'>','nbsp':' ','amp':'&','quot':'"','#39':"'"};
							var newContent = element.content.replace(/&(lt|gt|nbsp|amp|quot|#39);/ig,function(all,t){return arrEntities[t];});
							var content = newContent.replace(/<[^>]+>/g,"").replace(/(^\s+)|(\s+$)/g,"").replace(/(\r)|(\n)|(\t)/g,'');
						%>
							<p class="message-list-desc"><%= content %></p>
						<% } %>
						<div class="message-list-info">
							<p class="message-list-info-user"><img class="avatar" src="<%=  element.headImg ? CAICUI.Common.host.img + element.headImg : 'images/avatar.jpg'  %>"><span class="message-list-info-span user-name"><%= element.sender %></span></p>
							<ul class="message-list-info-ul">
								<li class="message-list-info-li"><span class="vertical-line">|</span></li>
								<li class="message-list-info-li"><span class="message-list-info-span message-list-info-time"><%=  CAICUI.iGlobal.stringData(element.sentTime) %></span></li>
								<li class="message-list-info-li"><span class="vertical-line">|</span></li>
								<li class="message-list-info-li"><span class="message-list-info-span"><%= typeName %></span></li>
							</ul>
						</div>
					</div>
				</li>
			<% }) %>
			
			<div class="pagination-box">
				<ul class="pagination">
					<% 
						var pageTotal = Math.ceil(data.totalCount/+data.pageSize);
						var pageStart = +data.pageNo;
						var pagePrevs = 4;
						var pageNexts = 4;
						var pageStartI = 1;
						var pageForNum = pageStartI+pagePrevs+pageNexts;
						var pageNum = 0;
						if(pageTotal>pageForNum){
							if(pageStart<=pagePrevs){
								pageStartI = 1;
								pageForNum = pageForNum;
							}else if(pageStart<pagePrevs+pageNexts){
								pageForNum = pageForNum+2;
								pageStartI = pagePrevs-pageStartI;
							}else if(pageStart>=pagePrevs+pageNexts && pageStart<=pageTotal-pageNexts){
								pageForNum = pageStart+pageNexts;
								pageStartI = pageStart-pagePrevs;
							}else if(pageStart>pageTotal-pageNexts){
								pageForNum = pageTotal;
								pageStartI = pageTotal-pagePrevs-pagePrevs;
							}
						}else{
							pageForNum = pageTotal;
							pageStartI = pageStartI;
						}
						if(+pageForNum>+pageTotal){
							pageForNum = pageTotal;
						}
					%>
					<% if(pageStart>1){ %>
						<li class="pagination-li js-pagination-prev">
						  <a class="pagination-a pagination-prev" href="javascript:;">
						  &lt;
						  </a>
						</li>
					<% } %>
					
					<% if(pageStart>pagePrevs && pageStartI > 1){ %>
						<li class="pagination-li js-pagination-li" data-pageno="1"><a class="pagination-a" href="javascript:;">1...</a></li>
					<% } %>

					<% if(data.totalCount>20){ %>
						<% for(var i=pageStartI;i<=pageForNum;i++){ %>
							<li class="pagination-li js-pagination-li <%= i==data.pageNo ? 'active' : '' %> " data-pageno="<%= i %>"><a class="pagination-a" href="javascript:;"><%=i%></a></li>
						<% } %>
					<% } %>

					<% if(pageForNum != pageTotal && pageTotal-pageStart>pageNexts){ %>
						<li class="pagination-li js-pagination-li" data-pageno="<%= pageTotal %>"><a class="pagination-a" href="javascript:;"><%= pageTotal %>...</a></li>
					<% } %>

					<% if(pageStart<pageTotal){ %>
						<li class="pagination-li js-pagination-next">
						  <a class="pagination-a pagination-next" href="javascript:;">
						  &gt;
						  </a>
						</li>
					<% } %>
			  </ul>
			</div>
	
		</ul>
		<% }else{ %>
			<div class="no-data">
				<p class="no-data-p">Sorry~您还没有通知消息！</p>
			</div>
		<% } %>
	</div>

	
	
</script>