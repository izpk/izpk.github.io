define(["jquery","underscore","backbone","layer"],function(e,t,i,n){"use strict";return i.View.extend({el:"body #right",template:t.template(e("#template-help").html()),events:{"click .help-video-a":"openVideo","click .studycenter-video-close":"studycenterVideoClose","click .help-feedback":"openFeedbackPop","click  embed":"toolPlayer"},render:function(){CAICUI.render.$this=this,CAICUI.render.helpVideoCcid="",CAICUI.render.helpVideoDate=[{videoTitle:"测试1",ccid:"1300971499D9639C9C33DC5901307461"},{videoTitle:"测试2",ccid:"D953D9C8ADF01C6E9C33DC5901307461"},{videoTitle:"移动端-APP操作指南",ccid:"44FB6895C92F856A9C33DC5901307461"},{videoTitle:"移动端-我的-介绍",ccid:"FCE3C6B71454EE3A9C33DC5901307461"},{videoTitle:"移动端-课程功能页介绍",ccid:"7C7512DC3121DD079C33DC5901307461"},{videoTitle:"移动端-登录及中心页课程页",ccid:"D6B8FA9748A421379C33DC5901307461"},{videoTitle:"网页端-学习中心教程完整版",ccid:"1F98FB5D622FCADE9C33DC5901307461"},{videoTitle:"网页端-学习中心首页及移动APP",ccid:"BEEE9DAC920BCAF19C33DC5901307461"},{videoTitle:"网页端-我的课程",ccid:"DB8FE72BE6A067369C33DC5901307461"},{videoTitle:"网页端-课程学习页",ccid:"0F7AC0C2DB150F6A9C33DC5901307461"},{videoTitle:"网页端-我的笔记 问答 交流",ccid:"BDF625852E6385679C33DC5901307461"}],this.$el.html(this.template({helpVideoDate:CAICUI.render.helpVideoDate})),window.CAICUI.myScroll=CAICUI.iGlobal.iScroll("body #wrapper")},openFeedbackPop:function(){CAICUI.render.feedbackType=["视频课程问题","学习中心问题","试题报错","新版建议","学员服务"];var i=t.template(e("#template-feedback").html());e("body").append(i({feedbackType:CAICUI.render.feedbackType})),CAICUI.Request.ajax({server:"member",data:{token:CAICUI.User.token},done:function(t){"success"==t.state?(CAICUI.render.member=t.data,e("body .pop-input-tel").val(CAICUI.render.member.mobile?CAICUI.render.member.mobile:CAICUI.render.member.email)):console.log("member:"+t)},fail:function(e){console.log("member:"+e)}}),this.feedbackAnimate(".pop-html"),this.feedbackEvent()},feedbackAnimate:function(t){e(t).animate({opacity:1},1e3)},feedbackEvent:function(){var t=e("#help-feedback-pop");t&&(t.on("click",".pop-radio-label",function(){var t=e(this);t.siblings().removeClass("active"),t.addClass("active")}),t.on("click",".pop-button-confirm",function(){var t=e(".pop-radio-label.active").index(),i=CAICUI.render.feedbackType[t],o=e(".pop-textarea").val();if(o){var a=e(".pop-input-tel").val();if(a){var d="MacIntel"==navigator.platform?"苹果":"",c=navigator.userAgent.split(" "),r=(c.length,c[c.length-2].split("/")[0]+"-"+c[c.length-1].split("/")[0]);CAICUI.render.$this.feedbackAjax({memberId:CAICUI.User.memberId,memberName:CAICUI.User.nickname,cmptType:i,cmptContent:o,contactWay:a,deviceDesc:d+" "+r})}else n.msg("Sorry~ 请输入联系方式！",function(){})}else n.msg("Sorry~ 请输入内容！",function(){})}),t.on("click",".pop-button-cancel",function(){t.remove(),t.off()}))},feedbackAjax:function(t){CAICUI.Request.ajax({server:"addLMG",data:t,done:function(t){e(".pop-html").remove(),n.msg("提交成功",{icon:1,time:1e3},function(){e("#help-feedback-pop").remove(),e("#help-feedback-pop").off()})},fail:function(e){n.msg("Sorry~ ",function(){})}})},openVideo:function(t){var i=CAICUI.iGlobal.getThat(t),n=i.parent().index(),o=i.attr("data-ccid");i.attr("data-videoTitle");CAICUI.render.helpVideoCcid=o,this.addAnimate(CAICUI.render.helpVideoDate[n].videoTitle,"template-help-video",function(){e("body #studycenter-video-main").append('<iframe allowtransparency="true" width="100%" height="100%" scrolling="no" frameborder="0" src="player.html?ccid='+o+'"></iframe>')})},addAnimate:function(i,n,o){e(window).width();var a=e(window).height(),d=t.template(e("#"+n).html());e("body").append(d({title:i})),e(".studycenter-video-close").on("click",function(){CAICUI.render.$this.removeAnimate()}),e("#animate").animate({height:a,top:"0"},300,function(){o&&o()})},removeAnimate:function(t){e("#animate").animate({height:"0",top:"50%"},300,function(){e("#animate").remove(),t&&t()})},studycenterVideoClose:function(){this.removeAnimate()}})});