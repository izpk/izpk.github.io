define(["jquery","underscore","backbone","views/exam-list","layer"],function(e,t,s,r,n){"use strict";return s.View.extend({el:"body #right",template:t.template(e("#template-my-exam").html()),events:{"click body":"layout","click .doRecord-chapter-li":"selectedDoRecord","click .myWrong-title-li":"selectedmyWrong","click .myExam-desc-btn":"myExamDescBtn","click .myExam-desc-continue":"myExamDescContinue","click .myExam-desc-view":"myExamDescView","click .myExam-desc-reset":"myExamDescReset","click .doRecord-chapter-del":"delMemberExercise","click .js-questions-option-click":"questionsOptionClick","keyup .js-questions-option-keyup":"questionsOptionKeyup","click .myWrong-answerResolution-btn":"analysis","click .js-pagination-li":"paginationChange","click .js-pagination-prev":"paginationPrev","click .js-pagination-next":"paginationNext"},render:function(t){CAICUI.render.this.exit&&"function"==typeof CAICUI.render.this.exit&&e("body #studycenter-video").length&&CAICUI.render.this.clearInitData(),CAICUI.render.this.exit&&"function"==typeof CAICUI.render.this.exit&&e("body .questions").length&&CAICUI.render.this.clearInitData(),CAICUI.render.this=this,CAICUI.render.$this=this,CAICUI.render.navType=t?+t:0,CAICUI.render.pageNo=1,CAICUI.render.pageSize=20,CAICUI.render.pageTotal=0,CAICUI.render.myExamDescData={},CAICUI.render.questionsDataCacheArray=[],CAICUI.render.answerArr=["A","B","C","D","E","F","G","H"],CAICUI.render.answerResolution={context:"",status:!0,rightAnswer:"",myAnswer:""},CAICUI.render.viewResolution=!1,CAICUI.render.readonly=!1,CAICUI.render.$this.$el.html(CAICUI.render.$this.template({data:""})),window.CAICUI.myScroll=CAICUI.iGlobal.iScroll("body #wrapper"),window.CAICUI.examTypeScroll=CAICUI.iGlobal.iScroll("body #wrapper-myExam-desc"),this.myExam(function(){CAICUI.render.this.initPage(CAICUI.render.navType)}),setTimeout(function(){e("body .myExam-nav-li").on("click",function(e){CAICUI.render.$this.myExamNavLi(e)})},300)},paginationChange:function(t){CAICUI.iGlobal.loading("body #scroller",{height:e("#wrapper").height()+"px"}),window.CAICUI.myScroll.refresh();var s=CAICUI.iGlobal.getThat(t);CAICUI.render.pageNo=s.attr("data-pageno"),this.initPage()},paginationPrev:function(t){CAICUI.render.pageNo>1&&(CAICUI.iGlobal.loading("body #scroller",{height:e("#wrapper").height()+"px"}),window.CAICUI.myScroll.refresh(),CAICUI.render.pageNo=+CAICUI.render.pageNo-1,this.initPage())},paginationNext:function(t){CAICUI.render.pageNo<=CAICUI.render.pageTotal-1&&(CAICUI.iGlobal.loading("body #scroller",{height:e("#wrapper").height()+"px"}),window.CAICUI.myScroll.refresh(),CAICUI.render.pageNo=+CAICUI.render.pageNo+1,this.initPage())},initPage:function(){switch(CAICUI.render.navType){case 0:this.myExam();break;case 1:this.myWrongTitle()}},myExam:function(t){this.examList(function(s){var r=e("#template-myExam-doRecord").html(),n=CAICUI.iGlobal.getTemplate(r,s);e("body #scroller").html(n),window.CAICUI.myScroll.refresh(),t&&t()})},myExamDesc:function(t){this.examDescAjax(function(s){for(var r=[],n=0;n<s.length;n++){var a=!0;console.log(s[n].sort),console.log(r);for(var i=0;i<r.length;i++)s[n].sort==r[i].sort&&(a=!1);a&&r.push(s[n])}s=r;var o=e("#template-myExam-doRecord-desc").html(),C=CAICUI.iGlobal.getTemplate(o,{data:s,myExamDescData:CAICUI.render.myExamDescData});e("body #scroller-myExam-desc").html(C),window.CAICUI.examTypeScroll.refresh(),t&&t()})},myWrongTitle:function(t){this.myWrongTitleAjax(function(s){var r=s.data;if(r&&r.length)for(var n=0;n<r.length;n++)if(r[n].exercise_list&&r[n].exercise_list.length)for(var a=0;a<r[n].exercise_list.length;a++)0;CAICUI.render.pageTotal=Math.ceil(s.count/CAICUI.render.pageSize);var i=e("#template-my-wrong-title").html(),o=CAICUI.iGlobal.getTemplate(i,{data:{myWrongTitle:s.data,pageNo:CAICUI.render.pageNo,pageSize:CAICUI.render.pageSize,totalCount:s.count}});e("body #scroller").html(o),window.CAICUI.myScroll.refresh(),t&&t()})},myWrongExercise:function(e){this.myWrongExerciseAjax(function(t){CAICUI.render.this.addDOMNidExerciseDetail(t[0]),e&&e()})},myExamNavLi:function(t){var s=CAICUI.iGlobal.getThat(t).index(),r="#myExam/"+s;window.location.hash=r,this.addActive(t),CAICUI.iGlobal.loading("body #scroller",{height:e("#wrapper").height()+"px"}),window.CAICUI.myScroll.refresh(),CAICUI.render.pageNo=1,CAICUI.render.navType=s,this.initPage()},addActive:function(e){var t=CAICUI.iGlobal.getThat(e);return t.siblings().removeClass("active"),t.addClass("active"),t},examList:function(e){CAICUI.Request.ajax({server:"get_exercise_knowledge_member_status",data:{member_id:CAICUI.User.memberId,pageNo:CAICUI.render.pageNo,pageSize:CAICUI.render.pageSize},done:function(t){if("success"==t.state&&t.data&&t.data.length){if(e){for(var s=t.data,r=[],n=0;n<s.length;n++)if(s[n].create_date){var a=s[n].create_date.split(" ")[0];if(r&&r.length){for(var i=!1,o=0,C=0;C<r.length;C++)r[C].create_year_date==a&&(i=!0,o=C);i?r[o].list.push(s[n]):r.push({create_year_date:a,list:[s[n]]})}else r.push({create_year_date:a,list:[s[n]]})}CAICUI.render.pageTotal=Math.ceil(t.count/CAICUI.render.pageSize),e({data:{examList:r,pageNo:CAICUI.render.pageNo,pageSize:CAICUI.render.pageSize,totalCount:t.count}})}}else e({data:{examList:{},pageNo:1,pageSize:20,totalCount:20}})},fail:function(t){e({data:{examList:{},pageNo:1,pageSize:20,totalCount:20}})}})},examDescAjax:function(e){CAICUI.Request.ajax({server:"get_user_knowledge_point_exercise_list",data:{member_id:CAICUI.User.memberId,knowledge_point_id:CAICUI.render.myExamDescData.knowledge_point_id,examenNum:CAICUI.render.myExamDescData.examenNum},done:function(t){e&&e(t.data)}})},myWrongTitleAjax:function(e){CAICUI.Request.ajax({server:"getMemberErrorExercise",data:{memberId:CAICUI.User.memberId,pageNo:CAICUI.render.pageNo,pageSize:CAICUI.render.pageSize},done:function(t){e&&e(t)}})},myWrongExerciseAjax:function(e){CAICUI.Request.ajax({server:"getNidExerciseDetail",data:{exerciseId:CAICUI.render.myWrongExerciseData.exerciseid},done:function(t){CAICUI.render.myWrongExerciseData.exerciseid=t.data[0].id,CAICUI.render.questionsDataCacheArray=t.data,e&&e(t.data)}})},delMemberExerciseAjax:function(e,t,s){CAICUI.Request.ajax({server:"delMemberExercise",data:{memberId:CAICUI.User.memberId,knowledgePointId:e,examenNum:t},done:function(e){console.log(e),s&&s(e.data)}})},setMemberErrorExerciseAjax:function(e){CAICUI.Request.ajax({server:"setMemberErrorExercise",data:{memberId:CAICUI.User.memberId,errorexerciseids:"",correctexerciseids:CAICUI.render.myWrongExerciseData.exerciseid,examenId:CAICUI.render.myWrongExerciseData.examen_id,examenName:CAICUI.render.myWrongExerciseData.exercise_name},done:function(t){console.log(t),e&&e(t.data)}})},delMemberExercise:function(e){e.preventDefault(),e.stopPropagation();var t=CAICUI.iGlobal.getThat(e).parent().parent(),s=t.attr("data-knowledge_point_id"),r=t.attr("data-examennum");this.delMemberExerciseAjax(s,r,function(){t.siblings()&&t.siblings().length?t.remove():t.parent().parent().remove(),window.CAICUI.myScroll.refresh()})},selectedDoRecord:function(t){var s=CAICUI.iGlobal.getThat(t),r=s.parent().parent();s.hasClass("active")||(CAICUI.iGlobal.loading("body #scroller-myExam-desc",{height:e("#wrapper-myExam-desc").height()+"px"}),window.CAICUI.examTypeScroll.refresh(),window.CAICUI.examTypeScroll.scrollTo(0,0),r.siblings().removeClass("active"),r.siblings().find("li").removeClass("active"),r.hasClass("active")||r.addClass("active"),s.siblings().removeClass("active"),s.addClass("active"),CAICUI.render.myExamDescData={examen_type:s.attr("data-examen_type"),knowledge_point_id:s.attr("data-knowledge_point_id"),examenNum:s.attr("data-examenNum"),examen_name:s.attr("data-examen_name"),examen_total_num:s.attr("data-examen_total_num"),is_finish:s.attr("data-is_finish"),error_num:s.attr("data-error_num"),last_exercise_nid:s.attr("data-last_exercise_nid"),course_id:s.attr("data-course_id"),chapter_id:s.attr("data-chapter_id"),task_id:s.attr("data-task_id"),correct_num:s.attr("data-correct_num")},CAICUI.render.$this.myExamDesc())},selectedmyWrong:function(t){var s=CAICUI.iGlobal.getThat(t),r=s.parent().parent();s.hasClass("active")||(CAICUI.iGlobal.loading("body #scroller-myExam-desc",{height:e("#wrapper-myExam-desc").height()+"px"}),CAICUI.render.readonly=!1,r.siblings().removeClass("active"),r.siblings().find("li").removeClass("active"),r.hasClass("active")||r.addClass("active"),s.siblings().removeClass("active"),s.addClass("active"),CAICUI.render.myWrongExerciseData={examen_id:s.attr("data-examen_id"),exercise_name:s.attr("data-exercise_name"),exerciseid:s.attr("data-exerciseid"),sort:s.attr("data-sort")},CAICUI.render.exerciseId=s.data("data-exerciseid"),CAICUI.render.isDone="false",CAICUI.render.$this.myWrongExercise())},myExamDescBtn:function(e){},myExamDescContinue:function(e){var t=CAICUI.iGlobal.getThat(e).attr("data-link");CAICUI.render.myExamContinue=CAICUI.render.myExamDescData,window.location.hash=t},myExamDescView:function(e){var t=CAICUI.iGlobal.getThat(e).attr("data-link");CAICUI.render.viewResolution=!0,CAICUI.render.myExamContinue=CAICUI.render.myExamDescData,window.location.hash=t},myExamDescReset:function(e){var t=CAICUI.iGlobal.getThat(e).attr("data-link");"knowledge"==CAICUI.render.myExamDescData.examen_type||"testSite"==CAICUI.render.myExamDescData.examen_type?this.delMemberExerciseAjax(CAICUI.render.myExamDescData.knowledge_point_id,CAICUI.render.myExamDescData.examenNum,function(){CAICUI.render.myExamContinue={},window.location.hash=t}):(CAICUI.render.myExamContinue={},window.location.hash=t)},addDOMNidExerciseDetail:function(t){var s=t,r=e("#template-questions-myWrong-content").html(),n=CAICUI.iGlobal.getTemplate(r,{myWrongExerciseData:CAICUI.render.myWrongExerciseData,item:s});e("body #scroller-myExam-desc").html(n),e("body #scroller-myExam-desc").find("img").each(function(t){var s=e(this).attr("src"),r=s.substr(-3);"jpg"!=r&&"png"!=r&&"gif"!=r&&"svg"!=r||(s=CAICUI.Common.host.static+s),e(this).attr("src",s)}),setTimeout(function(){window.CAICUI.examTypeScroll.refresh(),window.CAICUI.examTypeScroll.scrollTo(0,0)},300)},analysis:function(t){CAICUI.iGlobal.getThat(t);var s=this.$el.find(".questions-answerResolution");s.hasClass("active")||(CAICUI.render.readonly=!0,e("body .questions-options-box").find("input").attr("readonly","readonly"),e("body .questions-options-box").find("textarea").attr("readonly","readonly"),e("body .questions-body").addClass("questions-answerResolution-active"),this.questionsStatus(function(){console.log(CAICUI.render.status);var t=CAICUI.render.this.questionsResolution(CAICUI.render.questionsDataCacheArray[0].questionTypes,CAICUI.render.questionsDataCacheArray[0].context,CAICUI.render.questionsDataCacheArray[0].answerResolution);e("body .questions-answerResolution").html(t),s.addClass("active"),1==CAICUI.render.status&&CAICUI.render.this.setMemberErrorExerciseAjax(function(){e("body #myWrong-"+CAICUI.render.myWrongExerciseData.exerciseid).remove()})})),window.CAICUI.examTypeScroll.refresh()},getQuestionsDataCacheIndex:function(e,t){for(var s=0;s<CAICUI.render.questionsDataCacheArray.length;s++){if((CAICUI.render.questionsDataCacheArray[s].exercise_id||CAICUI.render.questionsDataCacheArray[s].exerciseId)==CAICUI.render.exerciseId)return CAICUI.render.questionsDataCache=CAICUI.render.questionsDataCacheArray[s],CAICUI.render.questionsDataCacheArray[s]}},questions:function(e,s,r){CAICUI.render.questionsAnswer="",CAICUI.render.typeHtml="",CAICUI.render.questionsType=e;if(CAICUI.render.isDone){"active";var n={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"',"#39":"'"},a=this.getQuestionsDataCacheIndex().context.replace(/&(lt|gt|nbsp|amp|quot|#39);/gi,function(e,t){return n[t]}),i=a.split('"false"');a="";for(var o=i.length,C=0;C<o;C++)a+=C==o-1?i[C]:i[C]+"false";var d=a.split('"true"');a="";for(o=d.length,C=0;C<o;C++)a+=C==o-1?d[C]:d[C]+"true";console.log(a);try{CAICUI.render.pushContext=JSON.parse(a)}catch(e){CAICUI.render.pushContext=JSON.parse(a.slice(1,a.length-1))}}else CAICUI.render.pushContext=JSON.parse(s);return CAICUI.render.answerResolution.context=r,"multiTask"===e?t.each(CAICUI.render.pushContext,function(e,t){CAICUI.render.typeHtml+='<div class="questions-options-box"><div class="questions-options-title">'+e.title+"</div>",CAICUI.render.this.questionsTypes(e.type,e.data,t),CAICUI.render.typeHtml+="</div>"}):(CAICUI.render.typeHtml+='<div class="questions-options-box">',CAICUI.render.this.questionsTypes(e,CAICUI.render.pushContext,0),CAICUI.render.typeHtml+="</div>"),CAICUI.render.typeHtml},questionsTypes:function(e,t,s,r){switch(e){case"checkbox":CAICUI.render.this.checkbox(t,s);break;case"radio":CAICUI.render.this.radio(t,s);break;case"question":CAICUI.render.this.question(t,s);break;case"blank":CAICUI.render.this.blank(t,s);break;case"matrixRadio":CAICUI.render.this.matrix("matrixRadio",t,s,r);break;case"matrixCheckbox":CAICUI.render.this.matrix("matrixCheckbox",t,s,r);break;case"matrixBlank":CAICUI.render.this.matrix("matrixBlank",t,s,r)}},checkbox:function(e,s){var r=!0,n="",a="";t.each(e,function(e,t){if(!CAICUI.render.this.optionRegExpTest(e.title)){var i="";e.isChecked&&(n+=CAICUI.render.answerArr[t]+" "),e.myChecked&&(i="active",a+=CAICUI.render.answerArr[t]+" "),e.isChecked!=e.myChecked&&(r=!1),CAICUI.render.typeHtml+='<div data-number="'+s+"-"+t+'" class="questions-hover questions-checkbox js-questions-option-click '+i+'"  data-mychecked='+e.myChecked+" data-ischecked="+e.isChecked+'><label><span class="questions-checkbox-input"></span><span class="questions-options-item">'+CAICUI.render.answerArr[t]+"：</span><div>"+e.title+"</div></label></div>"}}),CAICUI.render.answerResolution={status:r,rightAnswer:n,myAnswer:a}},radio:function(e,s){var r=!0,n="",a="";t.each(e,function(e,t){if(!CAICUI.render.this.optionRegExpTest(e.title)){var i="";e.isChecked&&(n+=CAICUI.render.answerArr[t]+" "),e.myChecked&&(i="active",a+=CAICUI.render.answerArr[t]+" "),e.isChecked!=e.myChecked&&(r=!1),CAICUI.render.typeHtml+='<div data-number="'+s+"-"+t+'" class="questions-hover questions-radio js-questions-option-click '+i+'" data-mychecked='+e.myChecked+" data-ischecked="+e.isChecked+'><label><span class="questions-radio-input"></span><span class="questions-options-item">'+CAICUI.render.answerArr[t]+"：</span><div>"+e.title+"</div></label></div>"}}),CAICUI.render.answerResolution={status:r,rightAnswer:n,myAnswer:a}},question:function(e,t){var s=!0,r="";e[0].myBlank&&(r=e[0].myBlank),e[0].blank!=e[0].myBlank&&(s=!1),CAICUI.render.typeHtml+='<div data-number="'+t+'-0" class="questions-question js-questions-option-keyup"><textarea>'+r+"</textarea></div>",CAICUI.render.answerResolution={status:s,rightAnswer:e[0].blank,myAnswer:e[0].myBlank}},blank:function(e,t){var s=!0,r="";e[0].myBlank&&(r=e[0].myBlank),e[0].blank!=e[0].myBlank&&(s=!1),CAICUI.render.typeHtml+='<div data-number="'+t+'-0" class="questions-blank js-questions-option-keyup"><input type="input" value='+r+"></div>",CAICUI.render.answerResolution={status:s,rightAnswer:e[0].blank,myAnswer:e[0].myBlank}},matrix:function(e,t,s,r){var n=t[0],a=(n.items.length,n.cols),i=n.rows;CAICUI.render.typeHtml+='<table class="questions-table questions-matrix questions-matrix-'+e+'"><tbody class="questions-tbody">';for(var o=0;o<i;o++){CAICUI.render.typeHtml+='<tr class="questions-tr">';for(var C=[],d=1;d<a;d++)C.push(d+o*a);for(var c=0;c<a;c++){var I=c+o*a,l=n.items[I],u="",m="";if(l.title&&I)CAICUI.render.typeHtml+='<td class="questions-td">'+l.title+"</td>";else if(I){switch(e){case"matrixRadio":l.myChecked&&(u=" active"),CAICUI.render.typeHtml+="<td data-mychecked="+l.myChecked+" data-rowsArray="+C+' data-number="'+s+"-"+I+'" class="questions-td  questions-radio js-questions-option-click'+u+'" data-ischecked='+l.isChecked+">",CAICUI.render.typeHtml+='<span class="questions-radio-input"></span>';break;case"matrixCheckbox":l.myChecked&&(u=" active"),CAICUI.render.typeHtml+="<td data-mychecked="+l.myChecked+' data-number="'+s+"-"+I+'" class="questions-td  questions-checkbox js-questions-option-click'+u+'" data-ischecked='+l.isChecked+">",CAICUI.render.typeHtml+='<span class="questions-checkbox-input"></span>';break;case"matrixBlank":l.myBlank&&(m=l.myBlank),CAICUI.render.typeHtml+='<td data-number="'+s+"-"+I+'" class="questions-td js-questions-option-keyup">',CAICUI.render.typeHtml+='<input type="text" value="'+m+'" >'}CAICUI.render.typeHtml+="</td>"}else CAICUI.render.typeHtml+='<td class="questions-td"></td>'}CAICUI.render.typeHtml+="</tr>"}CAICUI.render.typeHtml+="</tbody></table>"},questionsResolution:function(e,s,r){var n="";n=CAICUI.render.pushContext,"string"==typeof s&&(n=JSON.parse(s)),CAICUI.render.questionsAnswerHtml="",CAICUI.render.questionsAnswerHtml+='<p class="questions-answerResolution-p">问题解析</p>';var a=0,i="questions-answer-error";return 1==CAICUI.render.status?(a=1,CAICUI.render.questionsStatus="回答正确",i="questions-answer-success"):2==CAICUI.render.status?(a=2,CAICUI.render.questionsStatus="回答错误 正确答案是："):(a=0,CAICUI.render.questionsStatus="正确答案是："),1==a?(CAICUI.render.questionsAnswerHtml+='<div class="questions-answer-status '+i+'">',CAICUI.render.questionsAnswerHtml+='<span class="questions-answer ">'+CAICUI.render.questionsStatus+"</span>",CAICUI.render.questionsAnswerHtml+="</div>"):2==a&&("multiTask"==e?(CAICUI.render.questionsAnswerHtml+='<div class="questions-answer-status '+i+'">',CAICUI.render.questionsAnswerHtml+='<span class="questions-answer ">'+CAICUI.render.questionsStatus+"</span>",t.each(n,function(e,t){CAICUI.render.questionsAnswer="",CAICUI.render.questionsAnswerHtml+='<p class="questions-answerResolution-item">第'+(+t+1)+"题：</p>",CAICUI.render.this.questionsResolutionTypes(e.type,e.data,t,!0)})):(CAICUI.render.questionsAnswerHtml+='<div class="questions-answer-status '+i+'">',CAICUI.render.questionsAnswerHtml+='<span class="questions-answer ">'+CAICUI.render.questionsStatus+"</span>",this.questionsResolutionTypes(e,n,0,!0)),CAICUI.render.questionsAnswerHtml+="</div>"),CAICUI.render.questionsAnswerHtml+='<div class="questions-answerResolution-content">',CAICUI.render.questionsAnswerHtml+='<span class="questions-answerResolution-text">解析：</span>',CAICUI.render.questionsAnswerHtml+=r||"暂无解析",CAICUI.render.questionsAnswerHtml+="</div>",CAICUI.render.questionsAnswerHtml},questionsResolutionTypes:function(e,t,s,r){switch(e){case"checkbox":CAICUI.render.this.checkboxChecked(t,s),CAICUI.render.questionsAnswerHtml+='<span class="questions-answer">'+CAICUI.render.answerResolution.rightAnswer+"</span>";break;case"radio":CAICUI.render.this.radioChecked(t,s),CAICUI.render.questionsAnswerHtml+='<span class="questions-answer">'+CAICUI.render.answerResolution.rightAnswer+"</span>";break;case"question":CAICUI.render.this.questionChecked(t,s),CAICUI.render.questionsAnswerHtml+='<span class="questions-answer">'+CAICUI.render.answerResolution.rightAnswer+"</span>";break;case"blank":CAICUI.render.questionsAnswerHtml+='<span class="questions-answer">'+CAICUI.render.answerResolution.rightAnswer+"</span>";break;case"matrixRadio":CAICUI.render.this.matrixChecked("matrixRadio",t,s,r);break;case"matrixCheckbox":CAICUI.render.this.matrixChecked("matrixCheckbox",t,s,r);break;case"matrixBlank":CAICUI.render.this.matrixChecked("matrixBlank",t,s,r)}return CAICUI.render.questionsAnswerHtml},checkboxChecked:function(e,s){var r=!0,n="",a="";t.each(e,function(e,t){if(!CAICUI.render.this.optionRegExpTest(e.title)){var i="";e.isChecked&&(n+=CAICUI.render.answerArr[t]+" "),e.myChecked&&(i="active",a+=CAICUI.render.answerArr[t]+" "),e.isChecked!=e.myChecked&&(r=!1),CAICUI.render.typeHtml+='<div data-number="'+s+"-"+t+'" class="questions-hover questions-checkbox js-questions-option-click '+i+'"  data-mychecked='+e.myChecked+" data-ischecked="+e.isChecked+'><label><span class="questions-checkbox-input"></span><span class="questions-options-item">'+CAICUI.render.answerArr[t]+"：</span><div>"+e.title+"</div></label></div>"}}),CAICUI.render.answerResolution={status:r,rightAnswer:n,myAnswer:a}},radioChecked:function(e,s){var r=!0,n="",a="";t.each(e,function(e,t){if(!CAICUI.render.this.optionRegExpTest(e.title)){var i="";e.isChecked&&(n+=CAICUI.render.answerArr[t]+" "),e.myChecked&&(i="active",a+=CAICUI.render.answerArr[t]+" "),e.isChecked!=e.myChecked&&(r=!1),CAICUI.render.typeHtml+='<div data-number="'+s+"-"+t+'" class="questions-hover questions-radio js-questions-option-click '+i+'" data-mychecked='+e.myChecked+" data-ischecked="+e.isChecked+'><label><span class="questions-radio-input"></span><span class="questions-options-item">'+CAICUI.render.answerArr[t]+"：</span><div>"+e.title+"</div></label></div>"}}),CAICUI.render.answerResolution={status:r,rightAnswer:n,myAnswer:a}},questionChecked:function(e,t){var s=!0,r="";e[0].myBlank&&(r=e[0].myBlank),e[0].blank!=e[0].myBlank&&(s=!1),CAICUI.render.typeHtml+='<div data-number="'+t+'-0" class="questions-question js-questions-option-keyup"><textarea>'+r+"</textarea></div>",CAICUI.render.answerResolution={status:s,rightAnswer:e[0].blank,myAnswer:e[0].myBlank}},blankChecked:function(e,t){var s=!0,r="";e[0].myBlank&&(r=e[0].myBlank),e[0].blank!=e[0].myBlank&&(s=!1),CAICUI.render.typeHtml+='<div data-number="'+t+'-0" class="questions-blank js-questions-option-keyup"><input type="input" value='+r+"></div>",CAICUI.render.answerResolution={status:s,rightAnswer:e[0].blank,myAnswer:e[0].myBlank}},matrixChecked:function(e,t,s,r){var n=t[0],a=(n.items.length,n.cols),i=n.rows,o=!1,C="",d="",c="",I="",l="";CAICUI.render.questionsAnswerHtml+='<table class="questions-table questions-matrix questions-matrix-'+e+'"><tbody class="questions-tbody">';for(var u=0;u<i;u++){CAICUI.render.questionsAnswerHtml+='<tr class="questions-tr">';for(var m=[],h=1;h<a;h++)m.push(h+u*a);for(var A=0;A<a;A++){var p=A+u*a,y=n.items[p];if(o=!1,C="",I="",d=" js-questions-option-click",c=" js-questions-option-keyup",y.title&&p)CAICUI.render.questionsAnswerHtml+='<td class="questions-td">'+y.title+"</td>";else if(p){switch(r&&(d="",c="",y.isChecked&&(o=!0,C=" active"),y.blank&&(l="disabled",I=y.blank)),e){case"matrixRadio":CAICUI.render.questionsAnswerHtml+="<td data-mychecked="+o+" data-rowsArray="+m+' data-number="'+s+"-"+p+'" class="questions-td  questions-radio '+C+d+'" data-ischecked='+y.isChecked+">",CAICUI.render.questionsAnswerHtml+='<span class="questions-radio-input"></span>';break;case"matrixCheckbox":CAICUI.render.questionsAnswerHtml+="<td data-mychecked="+o+' data-number="'+s+"-"+p+'" class="questions-td  questions-checkbox '+C+d+'" data-ischecked='+y.isChecked+">",CAICUI.render.questionsAnswerHtml+='<span class="questions-checkbox-input"></span>';break;case"matrixBlank":CAICUI.render.questionsAnswerHtml+="<td data-mychecked="+o+' data-number="'+s+"-"+p+'" class="questions-td '+c+'">',CAICUI.render.questionsAnswerHtml+='<input type="text" value="'+I+'" '+l+">"}CAICUI.render.questionsAnswerHtml+="</td>"}else CAICUI.render.questionsAnswerHtml+='<td class="questions-td"></td>'}CAICUI.render.questionsAnswerHtml+="</tr>"}CAICUI.render.questionsAnswerHtml+="</tbody></table>"},questionsOptionClick:function(e){if(e.preventDefault(),CAICUI.render.readonly)return!1;var t=CAICUI.iGlobal.getThat(e),s=t.attr("data-mychecked"),r=t.attr("data-number").split("-");"true"==s?(t.removeClass("active"),s=!1,t.attr("data-mychecked",s)):(t.hasClass("questions-radio")&&(t.siblings().attr("data-mychecked","false"),t.siblings().removeClass("active")),t.addClass("active"),s=!0,t.attr("data-mychecked",s)),"multiTask"==CAICUI.render.questionsType?this.changeMultiTaskQuestionsDataClick(CAICUI.render.pushContext[r[0]].type,r,s,t):this.changeQuestionsDataClick(CAICUI.render.questionsType,r,s,t)},changeQuestionsDataClick:function(e,s,r,n){switch(e){case"radio":t.each(CAICUI.render.pushContext,function(e,t){e.myChecked=!1}),CAICUI.render.pushContext[s[1]].myChecked=r;break;case"checkbox":CAICUI.render.pushContext[s[1]].myChecked=r;break;case"matrixRadio":var a=n.attr("data-rowsarray").split(",");t.each(a,function(e,t){CAICUI.render.pushContext[0].items[e].myChecked=!1}),CAICUI.render.pushContext[0].items[s[1]].myChecked=r;break;case"matrixCheckbox":CAICUI.render.pushContext[0].items[s[1]].myChecked=r}},changeMultiTaskQuestionsDataClick:function(e,s,r,n){switch(e){case"radio":t.each(CAICUI.render.pushContext[s[0]].data,function(e,t){e.myChecked=!1}),CAICUI.render.pushContext[s[0]].data[s[1]].myChecked=r;break;case"checkbox":CAICUI.render.pushContext[s[0]].data[s[1]].myChecked=r;break;case"matrixRadio":var a=n.attr("data-rowsarray").split(",");t.each(a,function(e,t){CAICUI.render.pushContext[s[0]].data[0].items[e].myChecked=!1}),CAICUI.render.pushContext[s[0]].data[0].items[s[1]].myChecked=r;break;case"matrixCheckbox":CAICUI.render.pushContext[s[0]].data[0].items[s[1]].myChecked=r}},questionsOptionKeyup:function(e){e.preventDefault();var t=CAICUI.iGlobal.getThat(e),s=t.attr("data-number").split("-"),r=t.children().val();"multiTask"==CAICUI.render.questionsType?this.changeMultiTaskQuestionsDataKeyup(CAICUI.render.pushContext[s[0]].type,s,r,t):this.changeQuestionsDataKeyup(CAICUI.render.questionsType,s,r,t)},changeQuestionsDataKeyup:function(e,t,s,r){switch(e){case"blank":case"question":CAICUI.render.pushContext[t[1]].myBlank=s;break;case"matrixQuestion":case"matrixBlank":CAICUI.render.pushContext[0].items[t[1]].myBlank=s}},changeMultiTaskQuestionsDataKeyup:function(e,t,s,r){switch(e){case"blank":case"question":CAICUI.render.pushContext[t[0]].data[0].myBlank=s;break;case"matrixQuestion":CAICUI.render.pushContext[0].items[t[1]].myBlank=s;break;case"matrixBlank":CAICUI.render.pushContext[t[0]].data[0].items[t[1]].myBlank=s}},questionsStatus:function(e){if("multiTask"==CAICUI.render.questionsType){var s=0;t.each(CAICUI.render.pushContext,function(e,t){CAICUI.render.this.questionsStatusMultiTask(e.type,t)&&s++}),s==CAICUI.render.pushContext.length?CAICUI.render.status=1:CAICUI.render.status=2}else{var r=CAICUI.render.this.questionsStatusOther(CAICUI.render.questionsType);CAICUI.render.status=r?1:2}e&&e()},questionsStatusMultiTask:function(e,s){var r="",n=CAICUI.render.pushContext;if("matrixRadio"==e){r=!0;var a=0,i=0,o=0;t.each(n[s].data[0].items,function(e,t){e.isChecked&&(i++,e.myChecked&&o++)}),r=i==o,o&&(CAICUI.render.isMyChecked=!0)}else if("matrixCheckbox"==e){r=!0;a=0,i=0,o=0;t.each(n[s].data[0].items,function(e,t){e.isChecked&&e.myChecked&&a++,e.isChecked&&i++,e.myChecked&&o++}),r=o==i&&!(!i||!a||i!=a),o&&(CAICUI.render.isMyChecked=!0)}else if("radio"==e)r=!0,t.each(n[s].data,function(e,t){e.isChecked&&(r=!!e.myChecked),e.myChecked&&(CAICUI.render.isMyChecked=!0)});else if("checkbox"==e){r=!0;a=0,i=0,o=0;t.each(n,function(e,t){e.isChecked&&e.myChecked&&a++,e.isChecked&&i++,e.myChecked&&(o++,CAICUI.render.isMyChecked=!0)}),r=o==i&&!(!i||!a||i!=a)}else if("blank"==e){var C=(d=n[s].data[0]).blank;r=C==d.myBlank,d.myBlank&&(CAICUI.render.isMyChecked=!0)}else if("question"==e){var d;C=(d=n[s].data[0]).blank;r=!!d.myBlank,d.myBlank&&(CAICUI.render.isMyChecked=!0)}else"matrixBlank"==e&&(r=!0,t.each(n[s].data[0].items,function(e,t){var s=e.blank;s&&(r=s==e.myBlank),e.myBlank&&(CAICUI.render.isMyChecked=!0)}));return r},questionsStatusOther:function(e){var s="",r=CAICUI.render.pushContext;if("radio"==e)s=!0,t.each(r,function(e,t){e.isChecked&&(s=!!e.myChecked),e.myChecked&&(CAICUI.render.isMyChecked=!0)});else if("checkbox"==e){s=!0;var n=0,a=0,i=0;t.each(r,function(e,t){e.isChecked&&e.myChecked&&n++,e.isChecked&&a++,e.myChecked&&(i++,CAICUI.render.isMyChecked=!0)}),s=i==a&&!(!a||!n||a!=n)}else if("blank"==e){var o=r[0].blank;s=o==r[0].myBlank,r[0].myBlank&&(CAICUI.render.isMyChecked=!0)}else if("question"==e){o=r[0].blank;s=!!r[0].myBlank,r[0].myBlank&&(CAICUI.render.isMyChecked=!0)}else if("matrixRadio"==e){s=!0;n=0,a=0,i=0;t.each(r[index].data[0].items,function(e,t){e.isChecked&&(a++,e.myChecked&&i++)}),s=a==i,i&&(CAICUI.render.isMyChecked=!0)}else if("matrixCheckbox"==e){s=!0;n=0,a=0,i=0;t.each(r[index].data[0].items,function(e,t){e.isChecked&&e.myChecked&&n++,e.isChecked&&a++,e.myChecked&&i++}),s=i==a&&!(!a||!n||a!=n),i&&(CAICUI.render.isMyChecked=!0)}else"matrixBlank"==e&&(s=!0,t.each(r[0].items,function(e,t){var r=e.blank;r&&(s=r==e.myBlank),e.myBlank&&(CAICUI.render.isMyChecked=!0)}));return s},clearInitData:function(){clearInterval(CAICUI.render.timer),CAICUI.render.this.undelegateEvents(),CAICUI.render.cardOpen=!1,CAICUI.render.ExerciseTotalTime=0,CAICUI.render.errorNum=0,CAICUI.render.exerciseCount=0,CAICUI.render.exerciseDoneCount=0,CAICUI.render.exerciseNoDoneCount=0,CAICUI.render.exerciseRightCount=0},optionRegExpTest:function(e){var t=!1;if(e){var s=e.slice(0,2),r=e.slice(2);"选项"==s&&(t=new RegExp("点击这里编辑").test(r))}return t}})});