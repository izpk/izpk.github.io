define([],function(){"user strict";return{timer:function(){clearInterval(CAICUI.timer.interVal),CAICUI.timer.time=0,CAICUI.timer.interVal=setInterval(function(){CAICUI.timer.time++},1e3)},clearTimer:function(){clearInterval(CAICUI.timer.interVal)},getThat:function(e){return $(e.currentTarget)},getTemplate:function(e,t){var r=_.template(e);return r(t||{data:""})},getTemplateCourseNav:function(e,t){var r=$("#template-course-nav").html(),n=CAICUI.iGlobal.getTemplate(r,t);$(e).html(n)},getUrlPara:function(e){for(var t=location.href,r=t.indexOf("?"),n=t.substr(r+1).split("&"),a=0;a<n.length;a++){var i=n[a].split("=");if(i[0].toUpperCase()==e.toUpperCase())return decodeURI(i[1])}return""},loading:function(e,t){var r="";if(t)for(var n in t)r+=n+":"+t[n]+";";$(e).html('<div class="loader-box" style="'+r+'"><div class="loader">加载中。。。</div></div>')},addLiveAnimate:function(e){var t=$(window).width(),r=$(window).height();$("body").prepend('<div id="animate" style="background-color:#ddd;width:'+t+'px;"></div>'),$("#animate").animate({height:r,top:"0"},300,function(){e&&e()})},addAnimate:function(e){var t=$(window).width(),r=$(window).height();$("body").prepend('<div id="animate" style="width:'+t+'px;"></div>'),$("#animate").animate({height:r,top:"0"},300,function(){e&&e()})},addDomAnimate:function(e,t,r){$(window).width();var n=$(window).height(),a=_.template($("#"+t).html());$("body").append(a({title:e})),$(".studycenter-video-close").on("click",function(){CAICUI.render.$this.removeAnimate()}),$("#animate").animate({height:n,top:"0"},300,function(){r&&r()})},removeAnimate:function(e){$("#animate").animate({height:"0",top:"50%"},300,function(){$("#animate").remove(),e&&e()})},iScroll:function(e){if($(e).length){var t=new IScroll(e,{probeType:3,mouseWheel:!0,scrollbars:"custom",interactiveScrollbars:!0,shrinkScrollbars:"scale"}),r=!0;return t.on("scroll",function(){this.y?r&&($(e).append('<span class="wrapper-shadow"></span>'),r=!1):($(e).find(".wrapper-shadow").remove(),r=!0)}),t}},getDate:function(e,t){if(null==e)return"";var r=e.toString();r.length>11&&(r=r.substring(0,10));var n="";n=t&&"-"==t?"yyyy-MM-dd":"yyyy/MM/dd";var a=new Date(1e3*parseInt(r)),i={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),"S+":a.getMilliseconds()};for(var o in/(y+)/i.test(n)&&(n=n.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length))),i)new RegExp("("+o+")").test(n)&&(n=n.replace(RegExp.$1,1==RegExp.$1.length?i[o]:("00"+i[o]).substr((""+i[o]).length)));return n},getLocalTime:function(e,t){if(null==e)return"";var r=e.toString();r.length>11&&(r=r.substring(0,10));var n="yyyy-MM-dd h:m:s",a=new Date(1e3*parseInt(r)),i={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),"S+":a.getMilliseconds()};for(var o in/(y+)/i.test(n)&&(n=n.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length))),i)new RegExp("("+o+")").test(n)&&(n=n.replace(RegExp.$1,1==RegExp.$1.length?i[o]:("00"+i[o]).substr((""+i[o]).length)));for(var l=n.split(" "),s=l[0]+" ",c=l[1].split(":"),g=0;g<c.length;g++)g>0&&(s+=":"),1==c[g].length?s+="0"+c[g]:s+=c[g];return s},formatSeconds:function(e,t){var r=parseInt(e),n=0,a=0;r>60&&(n=parseInt(r/60),r=parseInt(r%60),n>60&&(a=parseInt(n/60),n=parseInt(n%60)));var i="";return"h"==t?(i=r>9?parseInt(r)+"s":r>0?"0"+parseInt(r)+"s":"0s",i=n>9?parseInt(n)+"m"+i:n>0?"0"+parseInt(n)+"m"+i:"0m"+i,i=a>9?parseInt(a)+"h"+i:a>0?parseInt(a)+"h"+i:"0h"+i):(i=r>9?parseInt(r):r>0?"0"+parseInt(r):"00",a>0&&(n+=60*a),i=n>9?parseInt(n)+":"+i:n>0?"0"+parseInt(n)+":"+i:"00:"+i),i},canvasRound:function(e,t){var r=document.getElementById(e);if(r&&r.getContext){var n=r.width,a=r.height,i=r.getAttribute("data-progress");0==i&&(i=.01);var o=r.getContext("2d"),l=1,s=setInterval(function(){if(l>20)clearInterval(s);else{if(o.clearRect(0,0,n,a),t&&t.bg&&(o.beginPath(),o.arc(n/2,a/2,n/2-1,1.5*Math.PI,100,!1),t&&t.bgBorderWidth?o.lineWidth=t.bgBorderWidth:o.lineWidth=1,t&&t.bgBorderColor?o.strokeStyle=t.bgBorderColor:o.strokeStyle="#fff",o.stroke()),i){var e=Math.PI*(i/20*l/100*2-.5);o.beginPath(),o.arc(n/2,a/2,n/2-1,1.5*Math.PI,e,!1),t&&t.borderWidth?o.lineWidth=t.borderWidth:o.lineWidth=2,t&&t.borderColor?o.strokeStyle=t.borderColor:o.strokeStyle="#fff",o.stroke()}o.closePath()}l++},40)}},stringData:function(e){e=parseInt(e);var t=parseInt((new Date).getTime()/1e3)-e;return t<0&&(t=1),t<3600?Math.ceil(t/60)+"分钟前":t>=3600&&t<86400?Math.ceil(t/3600)+"小时前":t>=86400&&t<2592e3?Math.ceil(t/86400)+"天前":t>=2592e3&&t<31104e3?Math.ceil(t/2592e3)+"月前":Math.ceil(parseInt(t/31104e3))+"年前"},filterImages:function(e){for(var t,r=/<img.*?src=(?:"|')?([^ "']*)/gi,n=0,a="";(t=r.exec(e))&&(console.log(t[1]),a+=t[1]+",",!(++n>3)););return a},filterHtml:function(e){return e.replace(/<\/?[^>]*>/g,"").replace(/[ | ]*\n/g,"").replace(/&nbsp;/gi,"").replace(/(^\s*)|(\s*$)/g,"")},cutstr:function(e,t){var r,n=0,a=new String;r=e.length;for(var i=0;i<r;i++){var o=e.charAt(i);if(n++,escape(o).length>4&&n++,a=a.concat(o),n>=t)return a=a.concat("...")}if(n<t)return e},html_decode:function(e){if(!e)return"";return 0==e.length?"":e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&#39;/g,"'").replace(/&quot;/g,'"').replace(/<br\/>/g,"\n").replace(/问题补充/gi,"<br/>问题补充:")},isChineseChar:function(e){return/[\u4E00-\u9FA5\uF900-\uFA2D]/.test(e)},getOpenCourseTime:function(e){if(null==e)return"";var t=e.toString();t.length>11&&(t=t.substring(0,10));var r="MM-dd h:m",n=new Date(1e3*parseInt(t)),a={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),"S+":n.getMilliseconds()};for(var i in/(y+)/i.test(r)&&(r=r.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+i+")").test(r)&&(r=r.replace(RegExp.$1,1==RegExp.$1.length?a[i]:("00"+a[i]).substr((""+a[i]).length)));for(var o=r.split(" "),l=o[0].split("-"),s=l[0]+"月"+l[1]+"日 ",c=o[1].split(":"),g=0;g<c.length;g++)g>0&&(s+=":"),1==c[g].length?s+="0"+c[g]:s+=c[g];return s},stringToEntity:function(e){var t={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"',"#39":"'"};return e.replace(/&(lt|gt|nbsp|amp|quot|#39);/gi,function(e,r){return t[r]}).replace(/<[^>]+>/g,"").replace(/(^\s+)|(\s+$)/g,"").replace(/(\r)|(\n)|(\t)/g,"")},bytesToSize:function(e){if(0===e)return"0 B";return sizes=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(1024)),(e/Math.pow(1024,i)).toPrecision(3)+" "+sizes[i]},getPercentage:function(e,t,r){var n=e?parseInt(e):0,a=t?parseInt(t):0,i=0,o=e;if(n&&a){var l=n/a;l>0&&l<.01&&(l=.01),i=parseInt(100*l)}else o&&(i=1);var s=i;return i>=100&&(s=100),s},fileUpload:function(e,t){var r="";r=e.formData?e.formData:new FormData($("#"+e.formClass)[0]),$.ajax({url:CAICUI.Common.fileUpload,type:"POST",data:r,async:!1,cache:!1,contentType:!1,processData:!1,success:function(e){t&&t(e)},error:function(e){}})},fileUploadAddList:function(e,t){var r=t.data;if(r&&r.length&&CAICUI.render.imgPathArray){var n=r[0].storeFileUrl;CAICUI.render.imgPathArray.push(n);var a=$('<div class="add-photo-show"><img class="add-photo-img" src="'+CAICUI.Common.host.img+n+'"><a class="add-photo-remove" data-src="'+n+'" href="javascript:;"><i class="icon icon-add-remove"></i></a></div>');a.find("img");$("body #"+e).val(""),$("body #"+e).before(a),$("body .add-photo-show").length>=5&&$("body #"+e).hide()}}}});